var images=[{id:"male",path:"male.png",png:!0,height:256,width:256,parent:"gender","default":!0},{id:"female",path:"female.png",png:!0,height:256,width:256,parent:"gender"},{id:"male-light",path:"body/male/light.png",parent:"shape",req:"male",layer:0,"default":!0},{id:"male-dark",path:"body/male/dark.png",parent:"shape",req:"male",layer:0},{id:"male-dark2",path:"body/male/dark2.png",parent:"shape",req:"male",layer:0},{id:"male-darkelf",path:"body/male/darkelf.png",parent:"shape",req:"male",layer:0},
{id:"male-darkelf2",path:"body/male/darkelf2.png",parent:"shape",req:"male",layer:0},{id:"male-tanned",path:"body/male/tanned.png",parent:"shape",req:"male",layer:0},{id:"male-tanned2",path:"body/male/tanned2.png",parent:"shape",req:"male",layer:0},{id:"male-orc",path:"body/male/orc.png",parent:"shape",req:"male",layer:0},{id:"male-red_orc",path:"body/male/red_orc.png",parent:"shape",req:"male",layer:0},{id:"skeleton",path:"body/male/skeleton.png",parent:"shape",req:"male",layer:0},{id:"female-light",
path:"body/female/light.png",parent:"shape",req:"female",layer:0},{id:"female-dark",path:"body/female/dark.png",parent:"shape",req:"female",layer:0},{id:"female-dark2",path:"body/female/dark2.png",parent:"shape",req:"female",layer:0},{id:"female-darkelf",path:"body/female/darkelf.png",parent:"shape",req:"female",layer:0},{id:"female-darkelf2",path:"body/female/darkelf2.png",parent:"shape",req:"female",layer:0},{id:"female-tanned",path:"body/female/tanned.png",parent:"shape",req:"female",layer:0},
{id:"female-tanned2",path:"body/female/tanned2.png",parent:"shape",req:"female",layer:0},{id:"female-orc",path:"body/female/orc.png",parent:"shape",req:"female",layer:0},{id:"female-red_orc",path:"body/female/red_orc.png",parent:"shape",req:"female",layer:0},{id:"hair_none",path:"",parent:"style",layer:1,"default":!0},{id:"facial_none",path:"",parent:"facial",layer:1,"default":!0},{id:"fiveoclock_black",path:"facial/male/fiveoclock/black.png",parent:"facial",layer:1,block:"bcolor",scale:4},{id:"eyes_blue",
path:"body/male/eyes/blue.png",parent:"eyes",layer:1,scale:3},{id:"eyes_brown",path:"body/male/eyes/brown.png",parent:"eyes",layer:1,scale:3},{id:"eyes_gray",path:"body/male/eyes/gray.png",parent:"eyes",layer:1,scale:3},{id:"eyes_green",path:"body/male/eyes/green.png",parent:"eyes",layer:1,scale:3},{id:"eyes_orange",path:"body/male/eyes/orange.png",parent:"eyes",layer:1,scale:3},{id:"eyes_purple",path:"body/male/eyes/purple.png",parent:"eyes",layer:1,scale:3},{id:"eyes_red",path:"body/male/eyes/red.png",
parent:"eyes",layer:1,scale:3},{id:"eyes_yellow",path:"body/male/eyes/yellow.png",parent:"eyes",layer:1,scale:3},{id:"default_ears",path:"",parent:"ears",layer:1,"default":!0},{id:"bigears_dark",path:"body/male/ears/bigears_dark.png",parent:"ears",req:{or:["male-dark","female-dark"]},layer:1,scale:2},{id:"bigears_dark2",path:"body/male/ears/bigears_dark2.png",parent:"ears",req:{or:["male-dark2","female-dark2"]},layer:1,scale:2},{id:"bigears_darkelf",path:"body/male/ears/bigears_darkelf.png",parent:"ears",
req:{or:["male-darkelf","female-darkelf"]},layer:1,scale:2},{id:"bigears_darkelf2",path:"body/male/ears/bigears_darkelf2.png",parent:"ears",req:{or:["male-darkelf2","female-darkelf2"]},layer:1,scale:2},{id:"bigears_light",path:"body/male/ears/bigears_light.png",parent:"ears",req:{or:["male-light","female-light"]},layer:1,scale:2},{id:"bigears_tanned",path:"body/male/ears/bigears_tanned.png",parent:"ears",req:{or:["male-tanned","female-tanned"]},layer:1,scale:2},{id:"bigears_tanned2",path:"body/male/ears/bigears_tanned2.png",
parent:"ears",req:{or:["male-tanned2","female-tanned2"]},layer:1,scale:2},{id:"elvenears_dark",path:"body/male/ears/elvenears_dark.png",parent:"ears",req:{or:["male-dark","female-dark"]},layer:1,scale:2},{id:"elvenears_dark2",path:"body/male/ears/elvenears_dark2.png",parent:"ears",req:{or:["male-dark2","female-dark2"]},layer:1,scale:2},{id:"elvenears_darkelf",path:"body/male/ears/elvenears_darkelf.png",parent:"ears",req:{or:["male-darkelf","female-darkelf"]},layer:1,scale:2},{id:"elvenears_darkelf2",
path:"body/male/ears/elvenears_darkelf2.png",parent:"ears",req:{or:["male-darkelf2","female-darkelf2"]},layer:1,scale:2},{id:"elvenears_light",path:"body/male/ears/elvenears_light.png",parent:"ears",req:{or:["male-light","female-light"]},layer:1,scale:2},{id:"elvenears_tanned",path:"body/male/ears/elvenears_tanned.png",parent:"ears",req:{or:["male-tanned","female-tanned"]},layer:1,scale:2},{id:"elvenears_tanned2",path:"body/male/ears/elvenears_tanned2.png",parent:"ears",req:{or:["male-tanned2","female-tanned2"]},
layer:1,scale:2},{id:"shirt_none",path:"",parent:"shirt",layer:1,"default":!0},{id:"female_bikini",path:"torso/dress_female/blue_vest.png",parent:"shirt",req:"female",layer:1},{id:"female_dress",path:"torso/dress_female/underdress.png",parent:"shirt",req:"female",layer:3,block:["legs","armor"]},{id:"female_dress_sash",path:"torso/dress_female/dress_w_sash_female.png",parent:"shirt",req:"female",layer:2,block:["legs","armor"]},{id:"female_tightdress_black",path:"torso/dress_female/tightdress_black.png",
parent:"shirt",req:"female",layer:3,block:["legs","armor"]},{id:"female_tightdress_red",path:"torso/dress_female/tightdress_red.png",parent:"shirt",req:"female",layer:3,block:["legs","armor"]},{id:"female_tightdress_white",path:"torso/dress_female/tightdress_white.png",parent:"shirt",req:"female",layer:3,block:["legs","armor"]},{id:"female_tightdress_lightblue",path:"torso/dress_female/tightdress_lightblue.png",parent:"shirt",req:"female",layer:3,block:["legs","armor"]},{id:"armor_none",path:"",parent:"armor",
layer:2,"default":!0},{id:"male_chain",path:"torso/chain/mail_male.png",parent:"armor",req:"male",layer:2},{id:"male_leather-chest",path:"torso/leather/chest_male.png",parent:"armor",req:"male",layer:2},{id:"male_plate-chest",path:"torso/plate/chest_male.png",parent:"armor",req:"male",layer:2},{id:"male_gold-chest",path:"torso/gold/chest_male.png",parent:"armor",req:"male",layer:2},{id:"female_chain",path:"torso/chain/mail_female.png",parent:"armor",req:"female",layer:2},{id:"female_leather-chest",
path:"torso/leather/chest_female.png",parent:"armor",req:"female",layer:2},{id:"female_plate-chest",path:"torso/plate/chest_female.png",parent:"armor",req:"female",layer:2},{id:"female_gold-chest",path:"torso/gold/chest_female.png",parent:"armor",req:"female",layer:2},{id:"legs_none",path:"",parent:"legs",layer:1,"default":!0},{id:"male_plate-legs",path:"legs/armor/male/metal_pants_male.png",parent:"legs",req:"male",layer:1},{id:"male_gold-legs",path:"legs/armor/male/golden_greaves_male.png",parent:"legs",
req:"male",layer:1},{id:"male_robe-skirt",path:"legs/skirt/male/robe_skirt_male.png",parent:"legs",req:"male",layer:3},{id:"female_plate-legs",path:"legs/armor/female/metal_pants_female.png",parent:"legs",req:"female",layer:1},{id:"female_gold-legs",path:"legs/armor/female/golden_greaves_female.png",parent:"legs",req:"female",layer:1},{id:"female_robe-skirt",path:"legs/skirt/female/robe_skirt_female.png",parent:"legs",req:"female",layer:3},{id:"head_none",path:"",parent:"head",layer:2,"default":!0},
{id:"male_cap",path:"head/caps/male/leather_cap_male.png",parent:"head",req:"male",layer:6},{id:"male_wizard-hat",path:"head/caps/male/wizard_hat_male.png",parent:"head",req:"male",layer:6},{id:"male_cloth-hood",path:"head/hoods/male/cloth_hood_male.png",parent:"head",req:"male",block:"style",layer:6},{id:"male_chain-hood",path:"head/hoods/male/chain_hood_male.png",parent:"head",req:"male",block:"style",layer:6},{id:"male_chain-hat",path:"head/helms/male/chainhat_male.png",parent:"head",req:"male",
layer:6},{id:"male_metal-helmet",path:"head/helms/male/metal_helm_male.png",parent:"head",req:"male",block:"style",layer:6},{id:"male_gold-helmet",path:"head/helms/male/golden_helm_male.png",parent:"head",req:"male",block:"style",layer:6},{id:"male_bandana_red",path:"head/bandanas/male/red.png",parent:"head",req:"male",layer:6},{id:"male_bandana_blue",path:"head/bandanas/male/blue.png",parent:"head",req:"male",layer:6},{id:"male_bandana_black",path:"head/bandanas/male/black.png",parent:"head",req:"male",
layer:6},{id:"female_cap",path:"head/caps/female/leather_cap_female.png",parent:"head",req:"female",layer:6},{id:"female_wizard-hat",path:"head/caps/female/wizard_hat_female.png",parent:"head",req:"female",layer:6},{id:"female_cloth-hood",path:"head/hoods/female/cloth_hood_female.png",parent:"head",req:"female",block:"style",layer:6},{id:"female_chain-hood",path:"head/hoods/female/chain_hood_female.png",parent:"head",req:"female",block:"style",layer:6},{id:"female_chain-hat",path:"head/helms/female/chainhat_female.png",
parent:"head",req:"female",layer:6},{id:"female_metal-helmet",path:"head/helms/female/metal_helm_female.png",parent:"head",req:"female",block:"style",layer:6},{id:"female_gold-helmet",path:"head/helms/female/golden_helm_female.png",parent:"head",req:"female",block:"style",layer:6},{id:"female_bandana_red",path:"head/bandanas/female/red.png",parent:"head",req:"female",layer:6},{id:"female_bandana_blue",path:"head/bandanas/female/blue.png",parent:"head",req:"female",layer:6},{id:"female_bandana_black",
path:"head/bandanas/female/black.png",parent:"head",req:"female",layer:6},{id:"hands_none",path:"",parent:"hands",layer:1,"default":!0},{id:"male_gold-gauntlet",path:"hands/gloves/male/golden_gloves_male.png",parent:"hands",req:"male",layer:1,scale:1.4,posy:-10},{id:"male_metal-gauntlet",path:"hands/gloves/male/metal_gloves_male.png",parent:"hands",req:"male",layer:1,scale:1.4,posy:-10},{id:"female_gold-gauntlet",path:"hands/gloves/female/golden_gloves_female.png",parent:"hands",req:"female",layer:1,
scale:1.4,posy:-10},{id:"female_metal-gauntlet",path:"hands/gloves/female/metal_gloves_female.png",parent:"hands",req:"female",layer:1,scale:1.4,posy:-10},{id:"shoulder_none",path:"",parent:"shoulder",layer:1,"default":!0},{id:"male_gold-shoulder",path:"torso/gold/arms_male.png",parent:"shoulder",req:"male",layer:3},{id:"male_metal-shoulder",path:"torso/plate/arms_male.png",parent:"shoulder",req:"male",layer:3},{id:"male_leather-shoulder",path:"torso/leather/shoulders_male.png",parent:"shoulder",
req:"male",layer:3},{id:"female_gold-shoulder",path:"torso/gold/arms_female.png",parent:"shoulder",req:"female",layer:3},{id:"female_metal-shoulder",path:"torso/plate/arms_female.png",parent:"shoulder",req:"female",layer:3},{id:"female_leather-shoulder",path:"torso/leather/shoulders_female.png",parent:"shoulder",req:"female",layer:3},{id:"feet_none",path:"",parent:"feet",layer:1,"default":!0},{id:"male_gold-feet",path:"feet/armor/male/golden_boots_male.png",parent:"feet",req:"male",layer:2,scale:1.5,
posy:-25},{id:"male_metal-feet",path:"feet/armor/male/metal_boots_male.png",parent:"feet",req:"male",layer:2,scale:1.5,posy:-25},{id:"male_shoes_black",path:"feet/shoes/male/black_shoes_male.png",parent:"feet",req:"male",layer:2,scale:1.5,posy:-25},{id:"male_shoes_brown",path:"feet/shoes/male/brown_shoes_male.png",parent:"feet",req:"male",layer:2,scale:1.5,posy:-25},{id:"female_gold-feet",path:"feet/armor/female/golden_boots_female.png",parent:"feet",req:"female",layer:2,scale:1.5,posy:-25},{id:"female_metal-feet",
path:"feet/armor/female/metal_boots_female.png",parent:"feet",req:"female",layer:2,scale:1.5,posy:-25},{id:"female_shoes_black",path:"feet/shoes/female/black_shoes_female.png",parent:"feet",req:"female",layer:2,scale:1.5,posy:-25},{id:"female_shoes_brown",path:"feet/shoes/female/brown_shoes_female.png",parent:"feet",req:"female",layer:2,scale:1.5,posy:-25},{id:"melee_none",path:"",parent:"melee",layer:1,"default":!0},{id:"ranged_none",path:"",parent:"ranged",layer:1,"default":!0},{id:"bow",path:"weapons/shoot/bow.png",
parent:"ranged",select:"arrows",layer:6,line:17,col:3,move:"shoot"},{id:"greatbow",path:"weapons/shoot/greatbow.png",parent:"ranged",select:"arrows",layer:6,line:17,col:3,move:"shoot"},{id:"recurvebow",path:"weapons/shoot/recurvebow.png",parent:"ranged",select:"arrows",layer:6,line:17,col:3,move:"shoot"},{id:"arcoreal",path:"weapons/shoot/arcoreal.png",parent:"ranged",select:"arrows",layer:6,line:17,col:3,move:"shoot"},{id:"arrows",path:"weapons/misc/arrow.png",parent:"none",layer:1},{id:"shield_none",
path:"",parent:"shield",layer:1,"default":!0},{id:"belt_none",path:"",parent:"belt",layer:1,"default":!0},{id:"male_belt_white-cloth",path:"belt/cloth/male/white_cloth_male.png",parent:"belt",req:"male",layer:4,scale:1.5,posy:-10},{id:"male_belt_leather",path:"belt/leather/male/leather_male.png",parent:"belt",req:"male",layer:4,scale:1.5,posy:-10},{id:"female_belt_white-cloth",path:"belt/cloth/female/white_cloth_female.png",parent:"belt",req:"female",layer:4,scale:1.5,posy:-10},{id:"female_belt_leather",
path:"belt/leather/female/leather_female.png",parent:"belt",req:"female",layer:4,scale:1.5,posy:-10},{id:"cape_none",path:"",parent:"cape",layer:1,"default":!0},{id:"oversize_spear",path:"weapons/oversize/two hand/either/spear.png",parent:"melee",layer:{"default":6,down:7},line:1,move:"thrust",oversize:!0,scale:1.7,posx:50,posy:40},{id:"oversize_dragonspear",path:"weapons/oversize/two hand/either/dragonspear.png",parent:"melee",layer:{"default":6,down:7},line:1,move:"thrust",oversize:!0,scale:1.7,
posx:50,posy:40},{id:"oversize_trident",path:"weapons/oversize/two hand/either/trident.png",parent:"melee",layer:{"default":6,down:7},line:1,move:"thrust",oversize:!0,scale:1.7,posx:50,posy:40},{id:"male_oversize_mace",path:"weapons/oversize/right hand/male/mace_male.png",parent:"melee",req:"male",layer:{"default":6,down:7},line:1,move:"slash",oversize:!0,scale:3,posx:150,posy:110},{id:"male_oversize_longsword",path:"weapons/oversize/right hand/male/longsword_male.png",parent:"melee",req:"male",layer:{"default":6,
down:7},line:1,move:"slash",oversize:!0,scale:3,posx:150,posy:110},{id:"male_oversize_rapier",path:"weapons/oversize/right hand/male/rapier_male.png",parent:"melee",req:"male",layer:{"default":6,down:7},line:1,move:"slash",oversize:!0,scale:3,posx:150,posy:110},{id:"male_oversize_saber",path:"weapons/oversize/right hand/male/saber_male.png",parent:"melee",req:"male",layer:{"default":6,down:7},line:1,move:"slash",oversize:!0,scale:3,posx:150,posy:110},{id:"female_oversize_mace",path:"weapons/oversize/right hand/female/mace_female.png",
parent:"melee",req:"female",layer:{"default":6,down:7},line:1,move:"slash",oversize:!0,scale:3,posx:150,posy:110},{id:"female_oversize_longsword",path:"weapons/oversize/right hand/female/longsword_female.png",parent:"melee",req:"female",layer:{"default":6,down:7},line:1,move:"slash",oversize:!0,scale:3,posx:150,posy:110},{id:"female_oversize_rapier",path:"weapons/oversize/right hand/female/rapier_female.png",parent:"melee",req:"female",layer:{"default":6,down:7},line:1,move:"slash",oversize:!0,scale:3,
posx:150,posy:110},{id:"female_oversize_saber",path:"weapons/oversize/right hand/female/saber_female.png",parent:"melee",req:"female",layer:{"default":6,down:7},line:1,move:"slash",oversize:!0,scale:3,posx:150,posy:110}];$(document).ready(function(){fill_assets()});
function fill_assets(){var c="black blonde blonde2 blue blue2 brown brown2 brunette brunette2 dark-blonde gold gray gray2 green green2 light-blonde light-blonde2 pink pink2 purple raven raven2 redhead redhead2 ruby-red white white-blonde white-blonde2 white-cyan".split(" "),a=[["beard","bigstache","frenchstache","mustache"],"bangs bangslong bangslong2 bangsshort bedhead bunches jewfro long longhawk longknot loose messy1 messy2 mohawk page page2 parted pixie plain ponytail ponytail2 princess shorthawk shortknot shoulderl shoulderr swoop unkempt xlong xlongknot".split(" ")],
e=['{"id": "A_B", "path": "facial/male/A/B.png", "parent": ["facial", "bcolor"], "layer": 1, "scale": 4}','{"id": "A_B", "path": "hair/male/A/B.png", "parent": ["style", "color"], "layer": 5}'];for(k=0;k<e.length;k++)for(i=0;i<a[k].length;i++)for(j=0;j<c.length;j++){var b=e[k];b=b.replace(/A/g,a[k][i]);b=b.replace(/B/g,c[j]);images.push(JSON.parse(b))}c="black blue brown green pink purple red teal white yellow".split(" ");a=[["longsleeve"],["pirate","sleeveless","corset"]];var f=[["torso/shirts/longsleeve/male/B_A.png"],
["torso/shirts/sleeveless/female/B_A.png","torso/shirts/sleeveless/female/B_A.png","torso/corset_female/A_B.png"]];b=["male","female"];e='{"id": "D_A_B", "path": "C", "parent": "shirt", "req": "D", "layer": 1}';for(k=0;k<b.length;k++)for(j=0;j<c.length;j++)for(i=0;i<a[k].length;i++){var g=e;g=g.replace(/C/g,f[k][i]);g=g.replace(/B/g,c[j]);g=g.replace(/A/g,a[k][i]);g=g.replace(/D/g,b[k]);images.push(JSON.parse(g))}c="black dark-blue teal green brown red magenta white".split(" ");b=["male","female"];
e='{"id": "D_pants_B", "path": "legs/pants/D/B_pants_D.png", "parent": "legs", "req": "D", "layer": 1}';for(k=0;k<b.length;k++)for(j=0;j<c.length;j++)a=e,a=a.replace(/B/g,c[j]),a=a.replace(/D/g,b[k]),images.push(JSON.parse(a));c=[{name:"spear",type:"thrust",line:5},{name:"staff",type:"thrust",line:5},{name:"dagger",type:"slash",line:13},{name:"woodwand",type:"slash",line:13},{name:"steelwand",type:"slash",line:13},{name:"sword",type:"slash",line:13},{name:"warhammer",type:"slash",line:13}];b=["male",
"female"];e='{"id": "A_B", "path": "weapons/C/A/B.png", "parent": "melee", "req": "A", "layer": {"default": 6, "down": 7}, "line": D, "move": "C"}';for(k=0;k<b.length;k++)for(j=0;j<c.length;j++)a=e,a=a.replace(/A/g,b[k]),a=a.replace(/B/g,c[j].name),a=a.replace(/C/g,c[j].type),a=a.replace(/D/g,c[j].line),images.push(JSON.parse(a));c="1 9 10 5 6 3 4 7 8".split(" ");b=["male","female"];e='{"id": "A_shield_B", "path": "weapons/shield pack/A/B.png", "parent": "shield", "req": "A", "layer": 6}';for(k=0;k<
b.length;k++)for(j=0;j<c.length;j++)a=e,a=a.replace(/A/g,b[k]),a=a.replace(/B/g,c[j]),images.push(JSON.parse(a));c="black blue brown gray green lavender pink red white yellow".split(" ");e=['{"id": "cape_B", "path": "torso/back/cape/normal/female/cape_B.png", "parent": "cape", "layer": 4, "select": "cape_B_behind", "line": 8}','{"id": "cape_B_behind", "path": "behind_body/cape/normal/female/cape_B.png", "parent": "none", "layer": -1, "line": 8}','{"id": "tattercape_B", "path": "torso/back/cape/tattered/female/tattercape_B.png", "parent": "cape", "layer": 4, "select": "tattercape_B_behind", "line": 8}',
'{"id": "tattercape_B_behind", "path": "behind_body/cape/tattered/female/tattercape_B.png", "parent": "none", "layer": -1, "line": 8}'];for(i=0;2>i;i++)for(j=0;j<c.length;j++)b=e.slice(),b[2*i]=b[2*i].replace(/B/g,c[j]),b[1+2*i]=b[1+2*i].replace(/B/g,c[j]),images.push(JSON.parse(b[2*i])),images.push(JSON.parse(b[1+2*i]));c="1 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27".split(" ");b=["male","female"];e='{"id": "A_oversize_B", "path": "weapons/weapon pack/A/bigslash/B.png", "parent": "melee", "req": "A", "layer": {"default": 6, "down": 7}, "line": 1, "move": "slash", "oversize": true, "scale": 3, "posx": 150, "posy": 110}';
for(k=0;k<b.length;k++)for(j=0;j<c.length;j++)a=e,a=a.replace(/A/g,b[k]),a=a.replace(/B/g,c[j]),images.push(JSON.parse(a))}
function fetchSpritesheet(c){var a=$.Deferred(),e={walk:{sprites:9,line:8},cast:{sprites:7,line:0},thrust:{sprites:8,line:4},slash:{sprites:6,line:12},shoot:{sprites:13,line:16}},b=!1;try{c=JSON.parse(c)}catch(p){b=!0,c={}}var f=document.createElement("canvas");f.setAttribute("width",2496);f.setAttribute("height",4032);var g=f.getContext("2d"),m=0,h=[],d;for(d in c)getImage(c[d])&&h.push(getImage(c[d]));validate_skin(h)||(b=!0);if(b)l=new Image,l.src="res/glad.png",l.onload=function(){for(var b=0;21>
b;b++)for(var c=0;13>c;c++)g.drawImage(l,64*c,64*b,64,64,64+192*c,64+192*b,64,64);return a.resolve(f)};else{var n=function(){for(var a=0;a<h.length;a++)if(l[a])if(h[a].oversize)for(var b=e[h[a].move].line,c=e[h[a].move].sprites,d=0;4>d;d++)for(var f=0;f<c;f++)g.drawImage(l[a],192*f,192*d,192,192,192*f,192*b+192*d,192,192);else for(d=0;21>d;d++)for(f=0;13>f;f++)g.drawImage(l[a],64*f,64*d,64,64,64+192*f,64+192*d,64,64)};h.sort(function(a,b){if(null==a.layer)return-1;if(null==b.layer)return 1;"object"===
typeof a.layer&&(a.layer=a.layer.down);"object"===typeof b.layer&&(b.layer=b.layer.down);return a.layer-b.layer});g.clearRect(0,0,f.width,f.height);var l=[];for(d=0;d<h.length;d++)if(h[d]&&""!=h[d].path&&!h[d].png)l[d]=new Image,l[d].src="sprite/Universal-LPC-spritesheet/"+h[d].path,l[d].onload=function(){m++;if(m==h.length)return n(),a.resolve(f)};else if(m++,m==h.length)return n(),a.resolve(f)}return a.promise()}
function validate_skin(c){for(var a in c)if("shape"==c[a].parent)return!0;return!1}function getSpriteThumb(c,a,e){var b={walk:{row:8,col:0},cast:{row:0,col:0},thrust:{row:4,col:0},slash:{row:12,col:0},shoot:{row:16,col:0},die:{row:20,col:5},up:0,left:1,down:2,right:3};e=b[a].row+b[e];a=b[a].col;b=document.createElement("canvas");b.setAttribute("width",64);b.setAttribute("height",64);b.getContext("2d").drawImage(c,192*a+64,192*e+64,64,64,0,0,64,64);return b}
function getImage(c){for(var a in images)if(images[a].id==c)return images[a]};
