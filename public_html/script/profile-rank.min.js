function noCredit(){new Message({message:"\n            <h3>Você não possui créditos suficientes</h3>\n            <div id='credit'><i class='fas fa-credit-card'></i></div>\n            <p>Recarregue seus créditos para poder continuar usando as funções da sua conta de tutor.</p>\n            ",buttons:{no:"CANCELAR",yes:"RECARREGAR"}}).show().click("yes",()=>{rechargeCredits()}),$("#dialog-box").addClass("school")}function rechargeCredits(){console.log("TODO: recarregar créditos")}$(document).ready(function(){var a={pages:{limit:10,geral:{offset:0}},show:async function(){let a=await post("back_rank.php",{action:"GET TABS"}),e=$("#ranking-container #tab-container .tab.selected").data("name");$("#ranking-container #tab-container .tab.user").remove();for(let n in a.tags){let t=a.tags[n],i="";t==e&&(i="selected"),$("#ranking-container #tab-container #add-tab").before(`<div class='tab user ${i}' data-name='${t}'>${t}</div>`),this.pages[t]||(this.pages[t]={offset:0})}user.premium||$("#ranking-container #tab-container #add-tab").hide(),this.bind();let n=0;$("#ranking-container #tab-container .tab").each((a,e)=>{n+=$(e).outerWidth()+5}),$("#ranking-container #tab-container #more-tabs").remove();let t=$("#ranking-container #tab-container").width();return n>t&&t>0&&($("#ranking-container #tab-container").append("<div id='more-tabs'><i class='fas fa-ellipsis-v'></i></div>"),$("#ranking-container #tab-container #more-tabs").css("margin-left",$("#ranking-container #tab-container").outerWidth()+5).click(function(){if($("#ranking-container #tab-container #tab-select").length)$("#ranking-container #tab-container #tab-select").remove();else{let a,e=[];$("#ranking-container #tab-container .tab").not("#add-tab").each((n,t)=>{$(t).hasClass("selected")&&(a=$(t).text()),e.push($(t).text())});let n="";for(let t of e){let e="";t==a&&(e="selected"),n+=`<div class='item ${e}'>${t}</div>`}$("#ranking-container #tab-container").append(`<div id='tab-select'>${n}</div>`),$("#ranking-container #tab-container #tab-select").css({top:$(this).offset().top+$(this).outerHeight()+10,left:$(this).offset().left-$("#ranking-container #tab-container #tab-select").width()+$(this).outerWidth()}).hide().slideDown(),$("#ranking-container #tab-container #tab-select .item").click(function(){var a=$(this).text();$("#ranking-container #tab-container .tab").each((e,n)=>{if($(n).text()==a){$(n).click(),$("#ranking-container #tab-container #tab-select").remove(),$("#ranking-container #tab-container").scrollLeft(0);let a=$("#ranking-container #tab-container").position().left,e=$(n).position().left-a,t=$("#ranking-container #tab-container").outerWidth(),i=Math.max(0,e+$(n).outerWidth()+100-t);$("#ranking-container #tab-container").scrollLeft(i)}})})}})),this},bind:function(){return $("#ranking-container #tab-container .tab").not("#add-tab").off().click(async function(){let e=!0;$("#ranking-container #tab-container .tab.selected").text()==$(this).text()&&(e=!1),$("#ranking-container #tab-container .tab").removeClass("selected"),$(this).addClass("selected"),user.premium&&($("#ranking-container #tab-container .tab.user i.close").remove(),$("#ranking-container #tab-container .tab.user.selected").append("<i class='fas fa-times close'></i>"),$("#ranking-container #tab-container .tab.user.selected .close").click(()=>{let e=$("#ranking-container #tab-container .tab.selected"),n=e.text(),t=new Message({message:`Deseja remover a aba <b>#${n}</b>`,buttons:{yes:"SIM",no:"NÃO"}});t.show(),t.click("yes",async()=>{let e=await post("back_rank.php",{action:"WATCH TAB",name:n,remove:!0});"SUCCESS"==e.status&&(a.show(),create_toast(`Aba #${n} removida`,"success"),$("#ranking-container #tab-container #tab-general").click())})}));let n=$(this).text().toLowerCase();$("#ranking-container #tab-general").hasClass("selected")&&(n="geral"),a.pages[n]&&a.fetch({id:n,offset:a.pages[n].offset,search:$("#ranking-container #search .input").val(),dummy:e})}),this},init:function(){$("#ranking-container #tab-container #add-tab").click(async function(){if(user.premium)if(parseFloat(user.credits)<=0)noCredit();else{let e=new Message({message:"Nome da <b>#hashtag</b> que deseja rastrear",buttons:{ok:"OK",cancel:"CANCELAR"},input:{placeholder:"suahashtag"},preventKill:!0});e.show(),$("#dialog-box .input").wrap("<div class='wrapper'></div>").before("<span><b>#</b></span>").focus(),e.click("ok",async n=>{let t=n.input.toLowerCase();""==t?e.kill():(match=t.match(/^#{0,1}([a-z0-9_]+)$/))?(e.kill(),a.add(match[1])):create_toast("A #hashtag deve conter somente letras, números e underline","error")}),e.click("cancel",()=>{e.kill()})}else new Message({message:"\n                        <h3>Transforme seu perfil em uma conta de tutor</h3>\n                        <img id='school' src='image/school.png'>\n                        <p>Adicione e remova tags para monitorar o desempenho de seus alunos nos treinos.</p>\n                        <p>Gere rankings personalizados e aumente o engajamento.</p>\n                        ",buttons:{no:"NÃO",yes:"SABER MAIS"}}).show().click("yes",()=>{window.open("about#plans")}),$("#dialog-box").addClass("school large")}),post("back_rank.php",{action:"MAXMINE"}).then(a=>{this.pages.geral.offset=Math.floor(a.offset/this.pages.limit)*this.pages.limit})},add:async function(a){let e=await post("back_rank.php",{action:"WATCH TAB",name:a,add:!0});"SUCCESS"==e.status?create_toast(`Aba #${a} criada`,"success"):"NOPREMIUM"==e.status?(create_toast("Esta função só pode ser usada por contas verificadas de instituições de ensino","error"),user.premium=!1):"NOCREDITS"==e.status&&(create_toast("Você não possui créditos para utilizar essa função","error"),user.credits=0),this.show()},fetch:async function({id:a="geral",limit:e=this.pages.limit,offset:n=0,search:t="",dummy:i=!0}){translator.translate(["Gladiador","Mestre","Renome","Pontuação total","Tempo médio dos treinos"]).then(async()=>{if(this.pages[a].offset=n,"geral"==a){if(i){$("#ranking-container .table").html(`<div class='row head'><div class='cell position'></div><div class='cell'>${translator.getTranslated("Gladiador")}</div><div class='cell'>${translator.getTranslated("Mestre")}</div><div class='cell mmr'>${translator.getTranslated("Renome")}</div></div>`);for(let a=0;a<e;a++)$("#ranking-container .table").append("<div class='row dummy'>\n                            <div class='cell position'><span class='dummy-text'>00°</span></div>\n                            <div class='cell'><span class='dummy-text'>GLADNAME</span></div>\n                            <div class='cell'><span class='dummy-text'>USERNAME</span></div>\n                            <div class='cell mmr'><span class='dummy-text'>0000</span></div>\n                        </div>")}$("#ranking-container .page-nav button").prop("disabled",!0);let s=await post("back_rank.php",{action:"GET",offset:n,search:t});if(i||$("#ranking-container .table").html(`<div class='row head'><div class='cell position'></div><div class='cell'>${translator.getTranslated("Gladiador")}</div><div class='cell'>${translator.getTranslated("Mestre")}</div><div class='cell mmr'>${translator.getTranslated("Renome")}</div></div>`),$("#ranking-container .table .row").not(".head").remove(),this.pages[a].total=s.total,s.total<n)return void this.fetch({id:a,offset:0,search:t});for(let a=0;a<e;a++)if(n+a<s.total){let e=s.ranking[a];$("#ranking-container .table").append(`<div class='row'>\n                            <div class='cell position'>${e.position}º</div>\n                            <div class='cell'>${e.glad}</div>\n                            <div class='cell'>${e.master}</div>\n                            <div class='cell mmr'><span class='change24'>${Math.abs(parseInt(e.change24))}</span>${parseInt(e.mmr)}</div>\n                        </div>`),user.apelido==e.master&&$("#ranking-container .table .row").last().addClass("mine"),parseInt(e.change24)>0?($("#ranking-container .table .mmr .change24").last().addClass("green"),$("#ranking-container .table .mmr .change24").last().prepend("<img src='icon/arrow-up-green.png'>")):parseInt(e.change24)<0&&($("#ranking-container .table .mmr .change24").last().addClass("red"),$("#ranking-container .table .mmr .change24").last().prepend("<img src='icon/arrow-up-green.png'>"))}else $("#ranking-container .table").append("<div class='row dummy'>\n                            <div class='cell position'></div>\n                            <div class='cell'></div>\n                            <div class='cell'></div>\n                            <div class='cell mmr'></div>\n                        </div>")}else{if(i){$("#ranking-container .table").html(`<div class='row head'><div class='cell position'></div><div class='cell'>${translator.getTranslated("Mestre")}</div><div class='cell mmr'><i class='fas fa-star' title='${translator.getTranslated("Pontuação total",dom=!1)}'></i></div><div class='cell mmr'><i class='fas fa-clock' title='${translator.getTranslated("Tempo médio dos treinos",dom=!1)}'></i></div></div>`);for(let a=0;a<e;a++)$("#ranking-container .table").append("<div class='row dummy'>\n                            <div class='cell position'><span class='dummy-text'>00°</span></div>\n                            <div class='cell'><span class='dummy-text'>USERNAME</span></div>\n                            <div class='cell mmr'><span class='dummy-text'>00</span></div>\n                            <div class='cell mmr'><span class='dummy-text'>000.0s</span></div>\n                        </div>")}$("#ranking-container .page-nav button").prop("disabled",!0);let s=await post("back_rank.php",{action:"FETCH",tab:a,search:t});if(i||$("#ranking-container .table").html("<div class='row head'><div class='cell position'></div><div class='cell'>Mestre</div><div class='cell mmr'><i class='fas fa-star' title='Pontuação total'></i></div><div class='cell mmr'><i class='fas fa-clock' title='Tempo médio dos treinos'></i></div></div>"),$("#ranking-container .table .row").not(".head").remove(),this.pages[a].total=s.ranking.length,s.ranking.length<n)return void this.fetch({id:a,offset:0,search:t});for(let a=0;a<e;a++)if(s.ranking[n+a]){let e=s.ranking[n+a],t=e.score%1?e.score.toFixed(1):e.score;$("#ranking-container .table").append(`<div class='row'>\n                            <div class='cell position'>${e.position}º</div>\n                            <div class='cell'>${e.nick}</div>\n                            <div class='cell mmr'>${t}</div>\n                            <div class='cell mmr'>${e.time.toFixed(1)}s</div>\n                        </div>`),user.id==e.id&&$("#ranking-container .table .row").last().addClass("mine")}else $("#ranking-container .table").append("<div class='row dummy'>\n                            <div class='cell position'></div>\n                            <div class='cell'></div>\n                            <div class='cell mmr'></div>\n                            <div class='cell mmr'></div>\n                        </div>")}$("#ranking-container .page-nav span").eq(0).html(0==this.pages[a].total?0:n+1),$("#ranking-container .page-nav span").eq(1).html(Math.min(n+e,this.pages[a].total)),$("#ranking-container .page-nav span").eq(2).html(this.pages[a].total),n>0&&$("#ranking-container #prev").removeAttr("disabled"),n+e<this.pages[a].total&&$("#ranking-container #next").removeAttr("disabled")})}};a.pages.next=function(){let e=$("#ranking-container .tab.selected").data("name"),n=$("#ranking-container #search .input").val();if(e){let t=a.pages[e].offset+a.pages.limit;a.fetch({id:e,offset:t,search:n})}},a.pages.prev=function(){let e=$("#ranking-container .tab.selected").data("name"),n=$("#ranking-container #search .input").val();if(e){let t=a.pages[e].offset-a.pages.limit;a.fetch({id:e,offset:t,search:n})}},$("#menu #ranking").click(async function(){a.show().then(()=>{$("#ranking-container .tab.selected").click()})}),$("#ranking-container #prev").click(function(){a.pages.prev()}),$("#ranking-container #next").click(function(){a.pages.next()}),$("#ranking-container #search .input").on("input",function(e){a.fetch({id:$("#ranking-container .tab.selected").text().toLowerCase(),search:$(this).val()})}),a.init()});