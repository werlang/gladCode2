var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(c,f,g){c instanceof String&&(c=String(c));for(var k=c.length,l=0;l<k;l++){var n=c[l];if(f.call(g,n,l,c))return{i:l,v:n}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(c,f,g){c!=Array.prototype&&c!=Object.prototype&&(c[f]=g.value)};$jscomp.getGlobal=function(c){return"undefined"!=typeof window&&window===c?c:"undefined"!=typeof global&&null!=global?global:c};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(c,f,g,k){if(f){g=$jscomp.global;c=c.split(".");for(k=0;k<c.length-1;k++){var l=c[k];l in g||(g[l]={});g=g[l]}c=c[c.length-1];k=g[c];f=f(k);f!=k&&null!=f&&$jscomp.defineProperty(g,c,{configurable:!0,writable:!0,value:f})}};$jscomp.polyfill("Array.prototype.find",function(c){return c?c:function(c,g){return $jscomp.findInternal(this,c,g).v}},"es6","es3");var user;
$(document).ready(function(){function c(){$.post("back_notification.php",{}).done(function(a){try{a=JSON.parse(a)}catch(v){console.log(v);var b=v}if(!b){$("#profile-ui #lvl span").html(a.user.lvl);b=130*(4.5*parseInt(a.user.lvl)-2);var e=parseInt(a.user.xp);$("#profile-ui #xp #filled").width(e/b*100+"%");$("#messages .notification").html(a.messages);0==parseInt(a.messages)?$("#messages .notification").addClass("empty"):$("#messages .notification").removeClass("empty");b=parseInt(a.friends);$("#friends .notification").html(b);
0==b?$("#friends .notification").addClass("empty"):$("#friends .notification").removeClass("empty");b=parseInt(a.glads.remaining);e=parseInt(a.glads.obsolete);$("#glads .notification").html(b+e);0==b+e?$("#glads .notification").addClass("empty"):$("#glads .notification").removeClass("empty");b=parseInt(a.duels);$("#battle .notification").html(b);0==b?$("#battle .notification").addClass("empty"):$("#battle .notification").removeClass("empty");a=parseInt(a.reports);$("#report .notification").html(a);
0==a?$("#report .notification").addClass("empty"):$("#report .notification").removeClass("empty")}setTimeout(function(){c()},1E4)})}function f(a){$.post("back_friends.php",{action:"FILTER",text:a}).done(function(a){a=JSON.parse(a);$("#panel #duel.wrapper #table-friends").html("");for(var b in a){var c="<div class='row'><div class='cell image'><img src='"+a[b].picture+"'></div><div class='cell nick'>"+a[b].nick+"</div></div>";$("#panel #duel.wrapper #table-friends").append(c);$("#panel #duel.wrapper #table-friends .row").last().data("user",
a[b].user)}$("#panel #duel.wrapper #table-friends .row").click(function(){$("#panel #duel.wrapper #table-friends .row").removeClass("selected");$(this).addClass("selected");$("#panel #duel.wrapper #challenge").removeProp("disabled")})})}function g(){function a(){$("#report-container #page-title span").eq(0).html(b);$("#report-container #page-title span").eq(1).html(e);$("#report-container #page-title span").eq(2).html(c);1==b?$("#report-container #prev").prop("disabled",!0):$("#report-container #prev").removeProp("disabled");
e==c?$("#report-container #next").prop("disabled",!0):$("#report-container #next").removeProp("disabled")}var b,e,c;"Batalhas"==$("#bhist-container .tab.selected").html()?$.post("back_report.php",{action:"GET",read:!0,page:q.battles}).done(function(d){try{d=JSON.parse(d)}catch(r){var m=r}if(m||0==d.length)$("#bhist-container .table").hide();else if(b=d.start,e=d.end,c=d.total,d=d.reports,0==c)$("#bhist-container .table").html("<p>Voc\u00ea ainda n\u00e3o possui batalhas</p>");else{a();$("#bhist-container .table").html("<div class='row head'><div class='cell'>Gladiador</div><div class='cell reward'>Renome</div><div class='cell time'>Data</div></div>");
for(var h in d)$("#bhist-container .table").append("<div class='row'><div class='cell glad'>"+d[h].gladiator+"</div><div class='cell reward'>"+parseFloat(d[h].reward).toFixed(1)+"</div><div class='cell time' title='"+getMessageTime(d[h].time,!0)+"'>"+getMessageTime(d[h].time)+"</div><div class='playback' title='Visualizar batalha'><a target='_blank' href='play/"+d[h].hash+"'><img src='icon/eye.png'></a></div></div>"),"0"==d[h].isread?$("#bhist-container .table .row").last().addClass("unread"):$("#bhist-container .table .row").last().removeClass("unread"),
0>d[h].reward?$("#bhist-container .table .reward").last().addClass("red"):0<d[h].reward&&(m=$("#bhist-container .table .reward").last(),m.addClass("green"),m.html("+"+m.html()))}}):"Duelos"==$("#bhist-container .tab.selected").html()&&$.post("back_duel.php",{action:"REPORT",page:q.duels}).done(function(d){try{d=JSON.parse(d)}catch(r){console.log(r);var m=r}if(m||0==d.length)$("#bhist-container").hide();else if(b=d.start,e=d.end,c=d.total,0==c)$("#bhist-container .table").html("<p>Voc\u00ea ainda n\u00e3o possui duelos</p>");
else{a();d=d.output;$("#bhist-container .table").html("<div class='row head'><div class='cell'>Gladiador</div><div class='cell'>Oponente</div><div class='cell'>Mestre</div><div class='cell time'>Data</div></div>");for(var h in d)$("#bhist-container .table").append("<div class='row'><div class='cell glad'>"+d[h].glad+"</div><div class='cell enemy'>"+d[h].enemy+"</div><div class='cell'>"+d[h].user+"</div><div class='cell time' title='"+getMessageTime(d[h].time,!0)+"'>"+getMessageTime(d[h].time)+"</div><div class='playback' title='Visualizar batalha'><a target='_blank' href='play/"+
d[h].log+"'><img src='icon/eye.png'></a></div></div>"),"0"==d[h].isread?$("#bhist-container .table .row").last().addClass("unread"):$("#bhist-container .table .row").last().removeClass("unread"),null==d[h].glad&&$("#bhist-container .table .row .glad").last().html("Gladiador Esquecido").addClass("forgotten"),null==d[h].enemy&&(null==d[h].log?($("#bhist-container .table .row .enemy").last().html("???"),$("#bhist-container .table .row").last().find(".playback").remove(),$("#bhist-container .table .row").last().append("<div class='remove' title='Cancelar desafio'>X</div>"),
$("#bhist-container .table .row").last().find(".remove").data("id",d[h].id).click(function(){var a=$(this).data("id");$.post("back_duel.php",{action:"DELETE",id:a}).done(function(a){showMessage("Desafio cancelado");g()})})):$("#bhist-container .table .row .enemy").last().html("Gladiador Esquecido").addClass("forgotten"))}})}function k(){$.post("back_rank.php",{page:u,search:x}).done(function(a){try{a=JSON.parse(a)}catch(r){console.log(r)}$("#ranking-container .table").html("<div class='row head'><div class='cell position'></div><div class='cell'>Gladiador</div><div class='cell'>Mestre</div><div class='cell mmr'>Renome</div></div>");
var b=a.start,e=a.end,c=a.total;u=a.page;a=a.glads;for(var d in a){var m=a[d].rank,h="";1==m?h="gold":2==m?h="silver":3==m&&(h="bronze");$("#ranking-container .table").append("<div class='row "+h+"'><div class='cell position'>"+m+"\u00ba</div><div class='cell'>"+a[d].glad+"</div><div class='cell'>"+a[d].user+"</div><div class='cell mmr'><span class='change24'>"+Math.abs(parseInt(a[d].change24))+"</span>"+parseInt(a[d].mmr)+"</div></div>");user.apelido==a[d].user&&$("#ranking-container .table .row").last().addClass("mine");
0<parseInt(a[d].change24)?($("#ranking-container .table .mmr .change24").last().addClass("green"),$("#ranking-container .table .mmr .change24").last().prepend("<img src='icon/arrow-up-green.png'>")):0>parseInt(a[d].change24)&&($("#ranking-container .table .mmr .change24").last().addClass("red"),$("#ranking-container .table .mmr .change24").last().prepend("<img src='icon/arrow-up-green.png'>"))}$("#ranking-container #page-title span").eq(0).html(b);$("#ranking-container #page-title span").eq(1).html(e);
$("#ranking-container #page-title span").eq(2).html(c);1==b?$("#ranking-container #prev").prop("disabled",!0):$("#ranking-container #prev").removeProp("disabled");e==c?$("#ranking-container #next").prop("disabled",!0):$("#ranking-container #next").removeProp("disabled")})}function l(){$("#message-panel #full-message").remove();$("#message-panel .table").show();$.post("back_message.php",{action:"GET",page:w}).done(function(a){try{a=JSON.parse(a)}catch(v){console.log(v)}var b=a.meta;a=a.info;if(0==
b.total)$("#message-panel .table").html("Voc\u00ea ainda n\u00e3o possui mensagens");else{$("#message-panel #page-title span").eq(0).html(b.start);$("#message-panel #page-title span").eq(1).html(b.end);$("#message-panel #page-title span").eq(2).html(b.total);1==b.page?$("#message-panel #prev").prop("disabled",!0):$("#message-panel #prev").removeProp("disabled");b.end==b.total?$("#message-panel #next").prop("disabled",!0):$("#message-panel #next").removeProp("disabled");$("#message-panel .table").html("");
for(var e in a)$("#message-panel .table").append("<div class='row'><div class='cell user'>"+a[e].nick+"</div><div class='cell message'>"+a[e].message+"</div><div class='cell time'>"+getMessageTime(a[e].time)+"</div></div>"),"0"==a[e].isread&&$("#message-panel .table .row").last().addClass("unread");$("#message-panel .table .row").click(function(){var b=$("#message-panel .table .row").index($(this)),d=a[b].id,e=a[b].message,c=getMessageTime(a[b].time,!0),f=a[b].nick;b=a[b].picture;$("#message-panel").append("<div id='full-message'><div class='row head'><div class='image'><img src='"+
b+"'></div><div class='user'>"+f+"</div><div class='time'>"+c+"</div></div><div class='row body'><div class='message'>"+e+"</div></div><div class='row buttons'><button class='button' id='back'><img src='icon/back.png'><span>Retornar</span></button><button class='button' id='reply'><img src='icon/reply.png'><span>Responder</span></button><button class='button' id='unread'><img src='icon/unread.png'><span>Marcar n\u00e3o lido</span></button><button class='button' id='delete'><img src='icon/delete2.png'><span>Excluir</span></button></div></div>");
$("#message-panel #full-message").hide();$("#message-panel .table").fadeOut(function(){$("#message-panel #full-message").toggle("scale")});$.post("back_message.php",{action:"READ",id:d,value:1});$("#message-panel #back").click(function(){$("#menu #messages").click()});$("#message-panel #reply").click(function(){$("#message-panel #full-message .row.buttons").hide();$("#message-panel #full-message").append("<div class='row reply'><textarea class='input'></textarea><div class='row buttons'><button class='button' id='send'><img src='icon/reply.png'><span>Enviar</span></button><button class='button' id='cancel'><img src='icon/delete2.png'><span>Descartar</span></button></div></div>");
$("#message-panel #full-message .reply").hide().fadeIn();$("#message-panel #full-message .input").focus();$("#message-panel #full-message .input").on("input",function(){var a=this.offsetHeight-this.clientHeight;300<=$(this).height()?$(this).height(300):$(this).css("height","auto").css("height",this.scrollHeight+a)});$("#message-panel #full-message #send").click(function(){var a=$("#message-panel #full-message .input").val();$.post("back_message.php",{action:"REPLY",replyid:d,message:a}).done(function(){$("#menu #messages").click();
$.post("back_sendmail.php",{action:"MESSAGE",replyid:d,message:a}).done(function(a){})})});$("#message-panel #full-message #cancel").click(function(){$("#message-panel #full-message .row.reply").remove();$("#message-panel #full-message .row.buttons").show()})});$("#message-panel #unread").click(function(){$.post("back_message.php",{action:"READ",id:d,value:0}).done(function(){$("#menu #messages").click()})});$("#message-panel #delete").click(function(){$.post("back_message.php",{action:"DELETE",id:d}).done(function(){$("#menu #messages").click()})})})}})}
function n(){var a=$("#friend-panel #friends .button-open.open"),b=$("#friend-panel #friends .options");b.removeClass("open");a.removeClass("open");b.removeProp("style")}function y(a,b){var e="<div id='fog'><div id='duel-box'><div id='title'>Escolha o gladiador que duelar\u00e1 contra <span class='highlight'>"+a+"</span> em nome da sua honra</div><div class='glad-card-container'></div><div id='button-container'><button id='cancel' class='button'>Cancelar</button><button id='invite' class='button' disabled>DESAFIAR</button></div></div></div>";
$("body").append(e);load_glad_cards($("#fog .glad-card-container"),{clickHandler:function(){$("#fog #btn-glad-open").removeProp("disabled");$("#fog .glad-preview").removeClass("selected");$(this).addClass("selected");$("#duel-box #invite").removeProp("disabled")},dblClickHandler:function(){$("#fog #duel-box #invite").click()}});$("#duel-box #cancel").click(function(){$("#fog").remove()});$("#duel-box #invite").click(function(){var e=$("#fog .glad-preview.selected").data("id"),d=$("#fog .glad-preview.selected .info .glad span").html();
$.post("back_duel.php",{action:"CHALLENGE",glad:e,friend:b}).done(function(e){$("#fog").remove();"EXISTS"==e?showMessage("J\u00e1 existe um desafio de duelo contra <span class='highlight'>"+a+"</span> usando o gladiador <span class='highlight'>"+d+"</span>."):"OK"==e?(showMessage("Desafio enviado para <span class='highlight'>"+a+"</span>. Assim que uma resposta for dada voc\u00ea ser\u00e1 notificado."),$.post("back_sendmail.php",{action:"DUEL",friend:b}).done(function(a){})):console.log(e)})})}function z(a){var b=
a.parents(".row").data("user");a=a.parents(".row").data("nick");showTextArea("Mensagem para <span class='highlight'>"+a+"</span>:","Ol\u00e1...",2048).then(function(a){a&&$.post("back_message.php",{action:"SEND",id:b,message:a}).done(function(e){showMessage("Mensagem enviada");$.post("back_sendmail.php",{action:"MESSAGE",receiver:b,message:a}).done(function(a){console.log(a)})})})}$("#header-container").addClass("small-profile");$("#header-profile").addClass("here");fill_assets();var p=["friend",
"message","update","duel","tourn"];$.post("back_login.php",{action:"GET"}).done(function(a){user=JSON.parse(a);$("#tab").length?(a=$("#tab").html(),$("#"+a).click(),$("#tab").remove()):$("#menu #profile").click();$("#profile-ui #picture img").attr("src",user.foto);$("#profile-ui #nickname").html(user.apelido);c();$.post("back_glad.php",{action:"GET"}).done(function(a){0==JSON.parse(a).length&&showDialog("Voc\u00ea ainda n\u00e3o possui nenhum gladiador cadastrado. Deseja ir para o editor de gladiadores?",
["Sim","N\u00e3o, obrigado"]).then(function(a){"Sim"==a&&(window.location.href="editor")})})});$("#menu .item").click(function(){if(!$(this).hasClass("disabled")){var a=$(this);$("#panel .content").removeClass("open");$.each($("#panel").find(".content"),function(){$(this).data("menu")==a.attr("id")&&$(this).addClass("open")});$("#menu .item").removeClass("here");$(this).addClass("here")}});$("#menu #profile").click(function(){$("#nickname .input").val(user.apelido);for(var a in p)"1"==user.preferences[p[a]]&&
$("#email #pref-"+p[a]+" input.checkslider").prop("checked",!0)});$("#profile-panel .button").click(function(){$("#profile-panel .button").prop("disabled",!0);for(var a in p)$("#email #pref-"+p[a]+" input.checkslider").prop("checked")?user.preferences[p[a]]="1":user.preferences[p[a]]="0";$.post("back_login.php",{action:"UPDATE",nickname:$("#nickname .input").val(),picture:user.foto,preferences:JSON.stringify(user.preferences)}).done(function(a){"DONE"==a?(showMessage("Informa\u00e7\u00f5es atualizadas"),
$("#profile-panel .button").removeProp("disabled"),user.apelido=$("#nickname .input").val(),$("#profile-ui #nickname").html(user.apelido),$("#profile-ui #picture img").attr("src",user.foto)):"EXISTS"==a&&(showMessage("Outro usu\u00e1rio j\u00e1 escolheu este nome").then(function(){$("#nickname .input").focus().select()}),$("#profile-panel .button").removeProp("disabled"))})});$("#menu #glads").click(function(){$.post("back_glad.php",{action:"GET"}).done(function(a){a=JSON.parse(a);var b=$("<div id='template'></div>").load("glad-card-template.html",
function(){$("#glads-container .glad-preview").remove();0<a.length&&$("#menu #battle").removeClass("disabled");for(var d in a)$("#glads-container .glad-card-container").append("<div class='glad-preview'></div>");$("#glads-container .glad-card-container .glad-preview").html(b);for(d in a)setGladImage($("#glads-container"),d,a[d].skin),$("#glads-container .glad-preview .info .glad span").eq(d).html(a[d].name),$("#glads-container .glad-preview .info .attr .str span").eq(d).html(a[d].vstr),$("#glads-container .glad-preview .info .attr .agi span").eq(d).html(a[d].vagi),
$("#glads-container .glad-preview .info .attr .int span").eq(d).html(a[d].vint),$("#glads-container .glad-preview").eq(d).data("id",a[d].id),$("#glads-container .glad-preview").eq(d).data("code",a[d].code),a[d].oldversion&&($("#glads-container .glad-preview").eq(d).addClass("old"),$("#glads-container .glad-preview .code .button").eq(d).html("{'atualizar'}")),$("#glads-container .glad-preview .delete").eq(d).click(function(){var a=$(this).parents(".glad-preview");showDialog("Deseja excluir o gladiador <span class='highlight'>"+
a.find(".glad span").html()+"</span>?",["Sim","N\u00e3o"]).then(function(b){"Sim"==b&&(a.fadeOut(function(){a.remove()}),$.post("back_glad.php",{action:"DELETE",id:a.data("id")}).done(function(a){$("#glads-container .glad-preview").last().after("<div class='glad-add'><div class='image'></div><div class='info'>Clique para criar um novo gladiador</div></div>");$("#glads-container .glad-add").first().click(function(){window.location.href="editor"})}))})}),$("#glads-container .glad-preview .code .button").eq(d).click(function(){var a=
$(this).parents(".glad-preview");if($(this).parents(".glad-preview").hasClass("old")){var b=$(this).parents(".info").find(".glad span").html();showDialog("A simula\u00e7\u00e3o da gladCode foi atualizada, e o c\u00f3digo do gladiador <span class='highlight'>"+b+"</span> precisa ser testado e salvo novamente para que ele volte a participar das batalhas. Clique no bot\u00e3o para abrir o editor",["Cancelar","OK"]).then(function(b){"OK"==b&&window.open("glad-"+a.data("id"))})}else b=a.data("code"),$("body").append("<div id='fog'><div id='code-box'><div class='close'>X</div><pre class='line-numbers language-c'><code class='language-c'>"+
b+"</code></pre><div id='button-container'><button id='editor' class='button'>Abrir no editor</button></div></div></div>"),Prism.highlightElement($("code")[0]),$("#fog").click(function(){$(this).remove()}),$("#code-box").click(function(a){a.stopPropagation()}),$("#code-box .close").click(function(a){$("#fog").click()}),$("#editor").click(function(){window.open("glad-"+a.data("id"));$("#fog").click()})})});$("#glads-container .glad-add").remove();for(var e=a.length;6>e;e++)if($("#glads-container .glad-card-container").append("<div class='glad-add'><div class='image'></div><div class='info'></div></div>"),
e<1+Math.floor(user.lvl/10))$("#glads-container .glad-add .info").last().html("Clique para criar um novo gladiador"),$("#glads-container .glad-add").last().click(function(){window.location.href="editor"});else{var c=10*(e-1+1);$("#glads-container .glad-add .info").last().html("Atinja o n\u00edvel "+c+" de mestre para desbloquear este gladiador");$("#glads-container .glad-add").last().addClass("inactive")}})});$("#menu #battle").click(function(){$("#match-find").prop("disabled",!0);$(this).hasClass("disabled")||
$.post("back_glad.php",{action:"GET"}).done(function(a){a=JSON.parse(a);var b=$("<div id='template'></div>").load("glad-card-template.html",function(){$("#battle-container .glad-preview").remove();for(var e in a)$("#battle-container .glad-card-container").append("<div class='glad-preview'></div>");$("#battle-container .glad-card-container .glad-preview").html(b);for(e in a)setGladImage($("#battle-container"),e,a[e].skin),$("#battle-container .glad-preview .info .glad span").eq(e).html(a[e].name),
$("#battle-container .glad-preview .info .attr .str span").eq(e).html(a[e].vstr),$("#battle-container .glad-preview .info .attr .agi span").eq(e).html(a[e].vagi),$("#battle-container .glad-preview .info .attr .int span").eq(e).html(a[e].vint),$("#battle-container .glad-preview").eq(e).data("id",a[e].id),$("#battle-container .glad-preview").eq(e).data("code",a[e].code),$("#battle-container .glad-preview").eq(e).data("name",a[e].name),$("#battle-container .glad-preview").eq(e).data("skin",a[e].skin),
$("#battle-container .glad-preview").eq(e).data("user",a[e].user),$("#battle-container .glad-preview").eq(e).data("vstr",a[e].vstr),$("#battle-container .glad-preview").eq(e).data("vagi",a[e].vagi),$("#battle-container .glad-preview").eq(e).data("vint",a[e].vint),$("#battle-container .glad-preview").eq(e).data("mmr",a[e].mmr),$("#battle-container .glad-preview .info .glad").eq(e).after("<div class='row mmr' title='Renome'><span>"+parseInt(a[e].mmr)+"</span><img src='icon/winner-icon.png'></div>"),
a[e].oldversion&&$("#battle-container .glad-preview").eq(e).addClass("old");$(".glad-preview .delete").remove();$(".glad-preview .code").remove();$("#battle-container .glad-preview").click(function(){$(this).hasClass("old")||($("#battle-container .glad-preview").removeClass("selected"),$(this).addClass("selected"),$("#match-find").removeProp("disabled"))})})});$.post("back_duel.php",{action:"GET"}).done(function(a){a=JSON.parse(a);$("#duel-challenge").addClass("hidden");1<=a.length&&$("#duel-challenge").removeClass("hidden");
$("#duel-challenge .table").html("");for(var b in a){var e=a[b].nick,c=a[b].time,d=a[b].lvl,f=a[b].picture;$("#duel-challenge .table").append("<div class='row'><div class='cell lvl-container'><img src='res/star.png' title='N\u00edvel'><span>"+d+"</span></div><div class='cell image-container'><img src='"+f+"'></div><div class='cell user'>"+e+"</div><div class='cell time' title='"+getMessageTime(c,!0)+"'>"+getMessageTime(c,!1)+"</div><div class='button-container'><div class='accept' title='Aceitar desafio'></div><div class='refuse' title='Recusar desafio'></div></div></div>");
$("#duel-challenge .table .row").last().data("id",a[b].id)}$("#duel-challenge .table .refuse").click(function(){var a=$(this).parents(".row"),b=a.data("id");$.post("back_duel.php",{action:"DELETE",id:b}).done(function(b){"OK"==b&&(a.remove(),0==$("#duel-challenge .table .row").length&&$("#duel-challenge").addClass("hidden"))})});$("#duel-challenge .table .accept").click(function(){var a=$(this).parents(".row"),b=a.find(".user").html(),d=a.data("id");a="<div id='fog'><div id='duel-box'><div id='title'>Escolha o gladiador que duelar\u00e1 contra <span class='highlight'>"+
b+"</span> em nome da sua honra</div><div class='glad-card-container'></div><div id='button-container'><button id='cancel' class='button'>Cancelar</button><button id='duel' class='button' disabled>DUELAR</button></div></div></div>";$("body").append(a);load_glad_cards($("#fog .glad-card-container"),{clickHandler:function(){$("#fog #btn-glad-open").removeProp("disabled");$("#fog .glad-preview").removeClass("selected");$(this).addClass("selected");$("#duel-box #duel").removeProp("disabled")},dblClickHandler:function(){$("#fog #duel-box #duel").click()}});
$("#fog #duel-box #duel").click(function(){var a=$("#fog .glad-preview.selected").data("id"),b=new progressButton($(this),["Executando batalha...","Aguardando resposta do servidor"]);runSimulation({duel:d,glads:a}).then(function(a){b.kill();$("#fog").remove();showMessage("Duelo conclu\u00eddo. Clique para visualizar a batalha.").then(function(){window.open("play/"+a)});$("#battle").click()})});$("#fog #duel-box #cancel").click(function(){$("#fog").remove()})})})});$("#panel #battle-mode .button").click(function(){$("#panel #battle-mode .button").removeClass("selected");
$(this).addClass("selected")});$("#panel #battle-mode #ranked.button").click(function(){$("#panel #battle-container .wrapper").hide();var a=$("#panel #battle-container #ranked.wrapper");"none"==a.css("display")&&a.fadeIn()});$("#panel #battle-mode #duel.button").click(function(){$("#panel #battle-container .wrapper").hide();var a=$("#panel #battle-container #duel.wrapper");"none"==a.css("display")&&a.fadeIn()});$("#panel #duel.wrapper .input").on("input",function(){var a=$("#panel #duel.wrapper .input").val();
f(a)});f("");$("#panel #duel.wrapper #challenge").click(function(){var a=$("#panel #duel.wrapper #table-friends .row.selected").data("user"),b=$("#panel #duel.wrapper #table-friends .row.selected .cell.nick").text();y(b,a)});$("#panel #battle-mode #tourn.button").click(function(){$("#panel #battle-container .wrapper").hide();var a=$("#panel #battle-container #tourn.wrapper");"none"==a.css("display")&&a.fadeIn();refresh_tourn_list()});$("#menu #report").click(function(){g()});$("#report-container .tab").click(function(){$("#report-container .tab").removeClass("selected");
$(this).addClass("selected");g()});var q={battles:1,duels:1,favorites:1};$("#report-container #prev").click(function(){"Batalhas"==$("#bhist-container .tab.selected").html()?q.battles--:"Duelos"==$("#bhist-container .tab.selected").html()&&q.duels--;g()});$("#report-container #next").click(function(){"Batalhas"==$("#bhist-container .tab.selected").html()?q.battles++:"Duelos"==$("#bhist-container .tab.selected").html()&&q.duels++;g()});$.post("back_glad.php",{action:"GET"}).done(function(a){0==JSON.parse(a).length&&
$("#menu #battle").addClass("disabled")});$("#battle-container #match-find").click(function(){var a=new progressButton($(this),["Executando batalha...","Aguardando resposta do servidor"]),b=$("#battle-container .glad-preview.selected"),e={id:b.data("id"),name:b.data("name"),skin:b.data("skin"),code:b.data("code"),user:b.data("user"),vstr:b.data("vstr"),vagi:b.data("vagi"),vint:b.data("vint"),mmr:b.data("mmr")};$.post("back_match.php",{action:"MATCH",id:e.id}).done(function(b){b=JSON.parse(b);b.push(e);
var d=preBattleShow(b);runSimulation({ranked:!0}).then(function(b){"ERROR"!=b&&(save_stats(b),$("#pre-battle-show #tips").html("Batalha conclu\u00edda. Clique para visualizar"),clearInterval(d),$("#pre-battle-show").addClass("complete"),$("#pre-battle-show").click(function(){window.open("play/"+b);$("#fog").remove();$("#menu #battle").click()}));a.kill()})})});var u=1,x="";$("#ranking-container #prev").click(function(){u--;k()});$("#ranking-container #next").click(function(){u++;k()});$("#menu #ranking").click(function(){k()});
$("#ranking-container #search .input").on("input",function(a){x=$(this).val();u=1;k()});var w=1;$("#message-panel #prev").click(function(){w--;l()});$("#message-panel #next").click(function(){w++;l()});$("#menu #messages").click(function(){l()});$("#friend-panel #request, #friend-panel #friends").addClass("hidden");$("#menu #friends").click(function(){$.post("back_friends.php",{action:"GET"}).done(function(a){a=JSON.parse(a);0<a.pending.length&&$("#friend-panel #request").removeClass("hidden");0<
a.confirmed.length&&$("#friend-panel #friends").removeClass("hidden");$("#friend-panel #request .table").html("");for(var b in a.pending){var e=a.pending[b].nick,c=a.pending[b].id,d=a.pending[b].picture,f=a.pending[b].lvl;$("#friend-panel #request .table").append("<div class='row'><div class='cell lvl-container'><img title='N\u00edvel' src='res/star.png'><span>"+f+"</span></div><div class='cell image-container'><img src='"+d+"'></div><div class='cell user'>"+e+"</div><div class='button-container'><div class='check' title='Aceitar solicita\u00e7\u00e3o'></div><div class='close' title='Recusar solicita\u00e7\u00e3o'></div></div></div>");
$("#friend-panel #request .table .row").last().data("id",c)}$("#friend-panel #friends .table").html("");for(b in a.confirmed){e=a.confirmed[b].nick;var h=a.confirmed[b].user;f=a.confirmed[b].lvl;c=a.confirmed[b].id;d=a.confirmed[b].picture;var g=last_active_string(a.confirmed[b].active);$("#friend-panel #friends .table").append("<div class='row'><div class='cell lvl-container'><img title='N\u00edvel' src='res/star.png'><span>"+f+"</span></div><div class='cell image-container'><img src='"+d+"'></div><div class='cell'>"+
e+"</div><div class='cell last-active'><span class='label'>\u00daltima atividade</span><span>"+g+"</span></div><div class='button-open'></div></div>");$("#friend-panel #friends .table .row").last().data({id:c,user:h,nick:e})}$("#friend-panel .check, #friend-panel .close").click(function(){var a="NO";$(this).hasClass("check")&&(a="YES");$.post("back_friends.php",{action:"REQUEST",answer:a,id:$(this).parents(".row").data("id")}).done(function(a){$("#menu #friends").click()})});$("#friend-panel #friends .button-open").click(function(){n();
var a=$(this);$("#friend-panel #friends .button-open").removeClass("open");$(this).addClass("open");var b=$("#friend-panel #friends .options");b.css({top:a.position().top,left:a.position().left+a.width()}).hide().animate({height:"toggle",width:"toggle",left:a.position().left-b.width()+a.width()},500,function(){b.addClass("open")})})})});$(window).click(function(a){$("#friend-panel #friends .options").hasClass("open")&&n()});$("#friend-panel #friends .unfriend").click(function(){var a=$("#friend-panel #friends .button-open.open"),
b=a.parents(".row"),e=a.parents(".row").data("id");a=a.parents(".row").data("nick");showDialog("Deseja remover <span class='highlight'>"+a+"</span> da sua lista de amigos?",["Sim","N\u00e3o"]).then(function(a){"Sim"==a&&$.post("back_friends.php",{action:"DELETE",user:e}).done(function(a){b.remove()})})});$("#friend-panel #friends .message").click(function(){var a=$("#friend-panel #friends .button-open.open");z(a)});$("#friend-panel #friends .duel").click(function(){var a=$("#friend-panel #friends .button-open.open"),
b=a.parents(".row").data("nick");a=a.parents(".row").data("user");y(b,a)});$("#friend-panel input").on("input",function(){var a=$(this).val();$.post("back_friends.php",{action:"SEARCH",text:a}).done(function(a){a=JSON.parse(a);$("#friend-panel #search .table").html("");for(var b in a){var c=a[b].nick,d=a[b].user;$("#friend-panel #search .table").append("<div class='row'><div class='cell'>"+c+"</div><div class='cell button-container'><div class='send-message' title='Enviar mensagem'></div><div class='add-friend' title='Enviar convite de amizade'></div></div></div>");
$("#friend-panel #search .table .row").last().data({user:d,nick:c})}$("#friend-panel #search .add-friend").click(function(){var a=$(this).parents(".row").data("nick"),b=$(this).parents(".row").data("user");$.post("back_friends.php",{action:"ADD",user:b}).done(function(d){"EXISTS"==d?showMessage("O usu\u00e1rio <span class='highlight'>"+a+"</span> j\u00e1 est\u00e9 em sua lista de amigos"):(showMessage("Convite enviado para <span class='highlight'>"+a+"</span>"),$.post("back_sendmail.php",{action:"FRIEND",
friend:b}).done(function(a){}))})});$("#friend-panel #search .send-message").click(function(){z($(this))})})});$("#menu #logout").click(function(){googleLogout().then(function(){window.location.href="index"})});$("#img-preview-container").hide();$("#img-upload").dropzone({url:"#",acceptedFiles:"image/*",previewTemplate:"<div class='dz-preview'></div>",accept:function(a,b){b()},init:function(){this.on("addedfile",function(a){$(".dz-preview").remove();$("#img-preview-container").append($(a.previewElement));
$("#img-preview-container").fadeIn()})},success:function(a,b){var c=new Image;c.src=a.dataURL;c.onload=function(){$(".dz-preview").html("<button id='crop-image' class='button'>RECORTAR IMAGEM</button><img src='"+c.src+"'>");var a=new Croppie($(".dz-preview img")[0],{viewport:{width:150,height:150},boundary:{width:300,height:300}});$(".cr-slider").addClass("slider");$("#crop-image").on("click",function(){a.result("base64").then(function(a){$("#img-upload").css({"background-image":"url("+a+")","background-size":"cover"});
user.foto=a;$("#img-preview-container").hide()})})}},error:function(a,b){},removedfile:function(a){},complete:function(a){}})});
function preBattleShow(c){$("#fog").remove();$("body").append("<div id='fog'><div id='pre-battle-show'><div class='glad-card-container'></div></div></div>");$("#fog").hide();for(var f in c)$("#pre-battle-show .glad-card-container").append("<div class='glad-preview'></div>");var g=$("<div id='template'></div>").load("glad-card-template.html",function(){$("#pre-battle-show .glad-card-container .glad-preview").html(g);for(var f in c)setGladImage($("#pre-battle-show"),f,c[f].skin),$("#pre-battle-show .glad-preview .info .glad span").eq(f).html(c[f].name),
$("#pre-battle-show .glad-preview .info .glad").eq(f).after("<div class='row user'><span>"+c[f].user+"</span></div>"),$("#pre-battle-show .glad-preview .info .user").eq(f).after("<div class='row mmr'><span>"+parseInt(c[f].mmr)+"</span><img src='icon/winner-icon.png'></div>"),$("#pre-battle-show .glad-preview .info .attr .str span").eq(f).html(c[f].vstr),$("#pre-battle-show .glad-preview .info .attr .agi span").eq(f).html(c[f].vagi),$("#pre-battle-show .glad-preview .info .attr .int span").eq(f).html(c[f].vint);
$("#pre-battle-show .glad-preview .delete-container").remove();$("#pre-battle-show .glad-preview .row.code").remove();$("#pre-battle-show").append("<div id='tips'><span></span></div><div id='progress'></div>");$("#pre-battle-show #tips").html(k[parseInt(Math.random()*k.length)]);$("#fog").fadeIn()}),k="Obrigado por fazer parte da vers\u00e3o beta da gladCode;Enquanto seu gladiador tiver menos de 1000 de renome, ele perder\u00e1 menos renome;Se voc\u00ea for o vencedor de uma batalha, seu gladiador ganhar\u00e1 muito renome;Mesmo quando perder uma batalha, o gladiador pode ganhar renome, dependendo do tempo que ficou vivo;Ser um dos primeiros a morrer \u00e9 a receita para perder grandes quantidades de renome;Se estiver enfrentando gladiadores mais fortes, o seu tende a ganhar mais renome;Gladiadores de renome semelhante s\u00e3o automaticamente selecionados para se enfrentar;Observe o comportamento de seus inimigos, e tente adaptar a l\u00f3gica do seu gladiador para derrot\u00e1-los;Quando voc\u00ea est\u00e1 offline, seus gladiadores podem ser desafiados. Eles podem subir ou descer no ranking;Voc\u00ea pode ver as \u00faltimas batalhas que seus gladiadores participaram no menu BATALHA;Voc\u00ea pode procurar por usu\u00e1rios ou enviar mensagens para seus amigos no menu AMIGOS;Participar de batalhas concede experi\u00eancia para o mestre, que lhe concede uma s\u00e9rie de benef\u00edcios;Est\u00e1 com d\u00favida em algo? pergunte na p\u00e1gina do facebook ou comunidade do reddit da gladCode;Seja um membro ativo da comunidade comentando e dando sua opini\u00e3o no facebook ou reddit;Assista o replay de suas batalhas, assim voc\u00ea entende melhor o comportamentos de seus gladiadores;A documenta\u00e7\u00e3o \u00e9 a melhor maneira de compreender como uma fun\u00e7\u00e3o funciona. Tem exemplos!;N\u00e3o entendeu algo sobre o funcionamento da gladCode? O manual da simula\u00e7\u00e3o est\u00e1 ali \u00e0 sua disposi\u00e7\u00e3o".split(";"),
l=0,n=setInterval(function(){var c=$("#battle-container #match-find").width();c=$("#battle-container #match-find #bar").width()/c;var f=$("#pre-battle-show").height()*c;$("#pre-battle-show #progress").css({height:f,"margin-top":-f});1<=c&&clearInterval(n);0==l/100%10&&(c=parseInt(Math.random()*k.length),$("#pre-battle-show #tips").html(k[c]));l++},10);return n}
function last_active_string(c){c=parseInt(c);var f=parseInt(c/60);c%=60;var g=parseInt(f/24);f%=24;var k=parseInt(g/30);g%=30;return 0<k?k+" meses":0<g?g+" dias":0<f?f+" horas":c+" minutos"}
function getMessageTime(c,f){if(f)return t=new Date(c),t.getDate()+" de "+"jan fev mar abr mai jun jul ago set out nov dez".split(" ")[t.getMonth()]+" de "+t.getFullYear()+" \u00e0s "+("0"+t.getHours()).slice(-2)+":"+("0"+t.getMinutes()).slice(-2);f=new Date;c=new Date(c);f=Math.round(f.getTime()/1E3);c=Math.round(c.getTime()/1E3);return last_active_string((f-c)/60)}function validate_skin(c){for(var f in c)if("shape"==c[f].parent)return!0;return!1};
