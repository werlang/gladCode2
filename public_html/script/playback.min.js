var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");var code,startloop=!1,json={},hashes=[],newindex=[],steps=[],timestep=0,pausesim=!0,stepIncrement=1,istep,tournHash,loghash;
$(document).ready(function(){$("#footer-wrapper").addClass("white");$("#tourn").html().length&&(tournHash=$("#tourn").html());$("#tourn").remove();if($("#log").html().length){var a=function(){$.post("back_log.php",{action:"GET",loghash:loghash}).done(function(c){if("NULL"==c)window.location.href=tournHash?"https://gladcode.tk/tournment.php?t="+tournHash:"https://gladcode.tk";else{try{b=JSON.parse(c)}catch(g){var f=g;console.log(g)}if(f)a();else{c=function(a,c,b){fetchSpritesheet(b).then(function(b){c[a]=
b})};var d=b[0].glads;stab=[];gender=[];for(var e in d){f=d[e].skin;c(e,hashes,f);f=JSON.parse(f);stab[e]="0";gender[e]="male";for(var k in f){var h=getImage(f[k]);"thrust"==h.move&&(stab[e]="1");"female"==h.id&&(gender[e]="female")}}var l=setInterval(function(){hashes.length==d.length&&(clearInterval(l),startBattle(b))},10)}}})},b;32<$("#log").html().length?showMessage("Erro na URL"):(loghash=$("#log").html(),a())}$("#log").remove();var c=4,d=[-10,-5,-2,-1,1,2,5,10];$("#back-step").click(function(){pausesim?
(0<stepIncrement?stepIncrement=-1:0<timestep&&(stepIncrement*=1.1),timestep+=Math.round(stepIncrement),$("#fowd-step .speed").html(""),$("#back-step .speed").html(Math.round(stepIncrement))):(0<c&&c--,stepIncrement=d[c],3>=c?($("#fowd-step .speed").html(""),$("#back-step .speed").html(d[c]+"x")):($("#back-step .speed").html(""),$("#fowd-step .speed").html(d[c]+"x")));clearInterval(istep);start_timer(steps)});$("#fowd-step").click(function(){pausesim?(0>stepIncrement?stepIncrement=1:timestep<$("#time").slider("option",
"max")-1&&(stepIncrement*=1.1),timestep+=Math.round(stepIncrement),$("#back-step .speed").html(""),$("#fowd-step .speed").html("+"+Math.round(stepIncrement))):(c<d.length-1&&c++,stepIncrement=d[c],3>=c?($("#fowd-step .speed").html(""),$("#back-step .speed").html(d[c]+"x")):($("#back-step .speed").html(""),$("#fowd-step .speed").html(d[c]+"x")));clearInterval(istep);start_timer(steps)});$("#pause").click(function(){stepIncrement=1;c=4;pausesim?(pausesim=!1,$("#pause #img-play").hide(),$("#pause #img-pause").show(),
$("#back-step .speed").html("-1x"),$("#fowd-step .speed").html("1x")):(pausesim=!0,$("#pause #img-pause").hide(),$("#pause #img-play").show(),stepIncrement=1,c=4,$("#back-step .speed").html("-1"),$("#fowd-step .speed").html("+1"));clearInterval(istep);start_timer(steps)});$("#fullscreen").click(function(){setFullScreen(!isFullScreen())});$("#help").click(function(){$("body").append("<div id='fog'><div id='help-window' class='blue-window'><div id='content'><h2>Controle da c\u00e2mera</h2><div class='table'><div class='row'><div class='cell'><img src='icon/mouse_drag.png'>/<img src='icon/arrows_keyboard.png'></div><div class='cell'>Mover a c\u00e2mera</div></div><div class='row'><div class='cell'><img src='icon/mouse_scroll.png'>/<img src='icon/plmin_keyboard.png'></div><div class='cell'>Zoom da arena</div></div><div class='row'><div class='cell'><img src='icon/select_glad.png'>/<img src='icon/numbers_keyboard.png'></div><div class='cell'>Acompanhar um gladiador</div></div></div><h2>Teclas de atalho</h2><div class='table'><div class='row'><div class='cell'><span class='key'>M</span></div><div class='cell'>Mostrar/ocultar molduras</div></div><div class='row'><div class='cell'><span class='key'>B</span></div><div class='cell'>Mostrar/ocultar barras de hp e ap</div></div><div class='row'><div class='cell'><span class='key'>F</span></div><div class='cell'>Mostrar/ocultar taxa de atualiza\u00e7\u00e3o</div></div><div class='row'><div class='cell'><span class='key'>ESPA\u00c7O</span></div><div class='cell'>Parar/Continuar simula\u00e7\u00e3o</div></div><div class='row'><div class='cell'><span class='key'>A</span></div><div class='cell'>Retroceder simula\u00e7\u00e3o</div></div><div class='row'><div class='cell'><span class='key'>D</span></span></div><div class='cell'>Avan\u00e7ar simula\u00e7\u00e3o</div></div></div></div><div id='button-container'><button class='button' id='ok'>OK</button></div></div></div>");
$("#help-window #ok").click(function(){$("#fog").remove()})});$("#settings").click(function(){$("body").append("<div id='fog'><div id='settings-window' class='blue-window'><h2>Prefer\u00eancias</h2><div class='check-container'><div id='pref-bars'><label><input type='checkbox' class='checkslider'>Mostrar barras de hp e ap</label></div><div id='pref-frames'><label><input type='checkbox' class='checkslider'>Mostrar molduras dos gladiadores</label></div><div id='pref-fps'><label><input type='checkbox' class='checkslider'>Mostrar taxa de atualiza\u00e7\u00e3o da tela (FPS)</label></div></div><div id='button-container'><button class='button' id='ok'>OK</button></div></div></div>");
showbars&&$("#pref-bars input").prop("checked",!0);"flex"==$("#ui-container").css("display")&&$("#pref-frames input").prop("checked",!0);showFPS&&$("#pref-fps input").prop("checked",!0);$(".checkslider").each(function(){create_checkbox($(this))});$("#settings-window #ok").click(function(){$("#fog").remove()});$("#pref-bars input").change(function(){showbars=$(this).prop("checked")?!0:!1});$("#pref-frames input").change(function(){$(this).prop("checked")?$("#ui-container").fadeIn():$("#ui-container").fadeOut()});
$("#pref-fps input").change(function(){showFPS=$(this).prop("checked")?!0:!1})});$("#time").slider({range:"min",min:0,max:0,value:timestep,create:function(a,b){$(this).append("<div class='ui-slider-time'></div>")},change:function(a,b){a=Math.floor(b.value/600);b=Math.floor(b.value/10)%60;10>b&&(b="0"+b);b=a+":"+b;$(this).find(".ui-slider-time").html(b);$(this).find(".ui-slider-time").css("left",$(this).find(".ui-slider-handle").css("left"))},slide:function(a,b){timestep=b.value}});$([window,document]).focusin(function(){}).focusout(function(){pausesim=
!1;$("#pause").click()})});function isFullScreen(){return document.fullscreenElement&&null!==document.fullscreenElement||document.webkitFullscreenElement&&null!==document.webkitFullscreenElement||document.mozFullScreenElement&&null!==document.mozFullScreenElement||document.msFullscreenElement&&null!==document.msFullscreenElement?!0:!1}
function setFullScreen(a){a?(a=document.getElementById("canvas-container"),a.requestFullscreen?a.requestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen?a.webkitRequestFullscreen():a.msRequestFullscreen&&a.msRequestFullscreen()):document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()}$(window).resize(function(){resize()});
function resize(){var a=$(window).height(),b=$(window).height()*screenW/screenH;game.scale.setGameSize(b,a);$(window).width()>$(window).height()?(game.camera.scale.x=$(window).height()/screenH,game.camera.scale.y=$(window).height()/screenH):(game.camera.scale.x=$(window).width()/screenW,game.camera.scale.y=$(window).width()/screenW);game.camera.bounds.width=screenW;game.camera.bounds.height=screenH}var show_final_score=!0;
function start_timer(a){istep=setInterval(function(){if(startloop){0>timestep&&(timestep=0);if(timestep>a.length-1){timestep=a.length-1;for(i in a[timestep].glads)if(0<a[timestep].glads[i].hp&&!$(".ui-glad").eq(i).hasClass("dead")&&(!e||c<a[timestep].glads[i].hp)){var b=a[timestep].glads[i].name;var c=a[timestep].glads[i].hp;var d=a[timestep].glads[i].user;var e=i}!$("#end-message").length&&show_final_score&&(e||(b="Empate",d=""),$("body").append("<div id='fog'><div id='end-message'><div id='victory'>VIT\u00d3RIA</div><div id='image-container'><div id='image'></div><div id='name-team-container'><span id='name'>"+
b+"</span><span id='team'>"+d+"</span></div></div><div id='button-container'><button class='button' id='retornar' title='Retornar para a batalha'>OK</button><button class='button small' id='share' title='Compartilhar'><img src='icon/share.png'></button></div></div></div>"),$("#end-message #retornar").click(function(){show_final_score=!1;$("#fog").remove();tournHash&&(window.location.href="https://gladcode.tk/tournment.php?t="+tournHash)}),$("#end-message #share").click(function(){$("#end-message").hide();
var a="gladcode.tk/play/"+loghash,b="<a id='twitter' class='button' title='Compartilhar pelo Twitter' href='https://twitter.com/intent/tweet?text=Veja%20esta%20batalha:&url=https://"+a+"&hashtags=gladcode' target='_blank'><img src='icon/twitter.png'></a>",c="<a id='facebook' class='button' title='Compartilhar pelo Facebook' href='https://www.facebook.com/sharer/sharer.php?u="+a+"' target='_blank'><img src='icon/facebook.png'></a>",d="<a id='whatsapp' class='button' title='Compartilhar pelo Whatsapp' href='https://api.whatsapp.com/send?text=Veja esta batalha:%0a"+
a+"%0a%23gladcode' target='_blank'><img src='icon/whatsapp.png'></a>";$("#fog").append("<div id='url'><div id='link'><span id='title'>Compartilhar batalha</span><span id='site'>gladcode.tk/play/</span><span id='hash'>"+loghash+"</span></div><div id='social'><div id='getlink' class='button' title='Copiar link'><img src='icon/link.png'></div>"+b+c+d+"</div><button id='close' class='button'>OK</button></div>");$("#url #social #getlink").click(function(){copyToClipboard(a);$("#url #hash").html("Link copiado");
$("#url #hash").addClass("clicked");setTimeout(function(){$("#url #hash").removeClass("clicked");$("#url #hash").html(loghash)},500)});$("#url #close").click(function(){$("#url").remove();$("#end-message").show()})}),e&&$("#end-message #image").html(getSpriteThumb(hashes[newindex[e]],"walk","down")),$("#end-message").hide(),$("#end-message").fadeIn(1E3),music.pause(),victory.play())}else show_final_score||($("#fog").remove(),show_final_score=!0,music.resume());phaser_update(a[timestep]);pausesim||
(timestep+=stepIncrement/Math.abs(stepIncrement))}},100/Math.abs(stepIncrement))}
function create_ui(a){$("#ui-container").html("");for(var b={$jscomp$loop$prop$i$0$2:0};b.$jscomp$loop$prop$i$0$2<a;b={$jscomp$loop$prop$i$0$2:b.$jscomp$loop$prop$i$0$2},b.$jscomp$loop$prop$i$0$2++)$("#ui-container").append("<div class='ui-glad'></div>"),$(".ui-glad").last().load("ui_template.html",function(a){return function(){$(this).click(function(){$(this).hasClass("follow")||$(this).hasClass("dead")?(game.camera.unfollow(),$(".ui-glad").removeClass("follow")):(game.camera.follow(sprite[a.$jscomp$loop$prop$i$0$2]),
$(".ui-glad").removeClass("follow"),$(this).addClass("follow"))})}}(b))}function startBattle(a){json={};startloop=!1;load_phaser();create_ui(a[0].glads.length);$("#time").slider("option","max",a.length);for(b=0;b<a[0].glads.length;b++)a[0].glads[b].name=a[0].glads[b].name.replace(/#/g," "),a[0].glads[b].user=a[0].glads[b].user.replace(/#/g," "),newindex[b]=b;for(var b in a)json.projectiles={},$.extend(!0,json,a[b]),steps.push(JSON.parse(JSON.stringify(json)));startloop=!0;start_timer(steps)};
