var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,b,d){a instanceof String&&(a=String(a));for(var c=a.length,e=0;e<c;e++){var g=a[e];if(b.call(d,g,e,a))return{i:e,v:g}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,d){a!=Array.prototype&&a!=Object.prototype&&(a[b]=d.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,d,c){if(b){d=$jscomp.global;a=a.split(".");for(c=0;c<a.length-1;c++){var e=a[c];e in d||(d[e]={});d=d[e]}a=a[a.length-1];c=d[a];b=b(c);b!=c&&null!=b&&$jscomp.defineProperty(d,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(b,a){return $jscomp.findInternal(this,b,a).v}},"es6","es3");var count_refresh_teams=0,count_refresh_tour_list=0,count_refresh_glads=0,teamsync={id:0,time:0};
$(document).ready(function(){$("#panel #tourn.wrapper #create").click(function(){function a(){var b=$(".tourn-box #maxtime .input").val();1==b.split("h ").length&&(b="00h "+b);var a=b.split("h ")[0];b=b.split("h ")[1].split("m")[0];return 59<parseInt(b)||23<parseInt(a)?0:1}$("body").append("<div id='fog'><div class='tourn-box'><div id='title'><h2>Criar torneio</h2><div id='public'><label>P\u00fablico<input type='checkbox' class='checkslider'></label></div></div><input id='name' class='input' placeholder='Identificador do torneio (nome)' maxlength='50'><input type='password' id='pass' class='input' placeholder='senha para ingressar' maxlength='32'><textarea id='desc' class='input' placeholder='Breve descri\u00e7\u00e3o...' maxlength='512'></textarea><div id='options'><div id='maxteams' class='col'><span>M\u00e1ximo de equipes</span><input class='input' value='50' maxlength='2'></div><div id='maxtime' class='col'><span>Tempo m\u00e1ximo da rodada</span><input class='input' value='23h 59m'></div><div id='flex-team'><label><input type='checkbox' class='checkslider'>Flex: Mestres podem inscrever mais de um gladiador</label></div></div><div id='button-container'><button id='cancel' class='button'>Cancelar</button><button id='create' class='button'>CRIAR</button></div></div></div>");
create_checkbox($(".tourn-box .checkslider"));$("#fog .tourn-box").hide().fadeIn();$(".tourn-box #cancel").click(function(){$("#fog").remove()});$(".tourn-box #maxtime .input").on("keydown",function(b){b.preventDefault();var a="",c=$(this).val(),e;for(e in c)"0"<=c[e]&&"9">=c[e]&&(0!=c[e]||0<e)&&(a+=c[e]);if("0"<=b.key&&"9">=b.key&&4>a.length)a+=b.key;else if(8==b.keyCode||46==b.keyCode)a=a.substr(0,a.length-1);0==a.length&&(a="0");b=a.substr(-4,Math.min(2,a.length-2));a=a.substr(-2,2);23<parseInt(b)&&
(b="23");2==b.length&&59<parseInt(a)&&(a="59");c=a+"m";""!=b&&(c=b+"h "+c);$(this).val(c)});$(".tourn-box #create").click(function(){var b=$(".tourn-box #name").val(),d=$(".tourn-box #pass").val(),c=$(".tourn-box #desc").val(),e=$(".tourn-box #maxteams input").val(),g=$(".tourn-box #maxtime input").val(),h=$(".tourn-box #flex-team input").prop("checked");$(".tourn-box .input").removeClass("error");$(".tourn-box .tip").remove();6>b.length?($(".tourn-box #name").focus(),$(".tourn-box #name").addClass("error"),
$(".tourn-box #name").before("<span class='tip'>O identificador precisa ter tamanho 6 ou mais</span>")):b.match(/[^\w\s]/g)?($(".tourn-box #name").focus(),$(".tourn-box #name").addClass("error"),$(".tourn-box #name").before("<span class='tip'>O identificador precisa conter somente letras, n\u00fameros ou espa\u00e7os</span>")):"none"!=$(".tourn-box #pass").css("display")&&0==d.length?($(".tourn-box #pass").focus(),$(".tourn-box #pass").addClass("error"),$(".tourn-box #pass").before("<span class='tip'>Digite uma senha, ou torne o torneio p\u00fablico</span>")):
e.match(/[^\d]/g)||2>e||50<e?($(".tourn-box #maxteams input").focus(),$(".tourn-box #maxteams input").addClass("error"),$(".tourn-box #maxteams input").before("<span class='tip'>Informe um n\u00famero entre 2 e 50</span>")):a()?$.post("back_tournament.php",{action:"CREATE",name:b,pass:d,desc:c,maxteams:e,maxtime:g,flex:h}).done(function(a){"EXISTS"!=a?($("#fog").remove(),a="<p>As equipes dever\u00e3o entrar com os seguintes dados para se inscrever em seu torneio:</p><div>Identificador: <span>"+b+
"</span></div><div>Senha: <span>"+d+"</span></div>",""==d&&(a="<p>As equipes dever\u00e3o procurar seu torneio na lista de torneios p\u00fablicos, ou entrar com o seguinte identificador para se inscrever em seu torneio:</p><div>Identificador: <span>"+b+"</span></div>"),a="<div id='fog'><div id='tourn-message' class='tourn-box'><h2>Torneio registrado</h2>"+a+"<div id='button-container'><button class='button'>OK</button></div></div></div>",$("body").append(a),$("#tourn-message .button").click(function(){$("#fog").remove();
refresh_tourn_list()})):($(".tourn-box #name").focus(),$(".tourn-box #name").addClass("error"),$(".tourn-box #name").before("<span class='tip'>Um torneio com este identificador j\u00e1 existe</span>"))}):($(".tourn-box #maxtime input").focus(),$(".tourn-box #maxtime input").addClass("error"),$(".tourn-box #maxtime input").before("<span class='tip'>Formato de hora inv\u00e1lida</span>"))});$(".tourn-box #public .checkslider").click(function(){$(".tourn-box .input").removeClass("error");$(".tourn-box .tip").remove();
$(this).prop("checked")?$(".tourn-box #pass").hide().val(""):$(".tourn-box #pass").show()})});$("#panel #tourn.wrapper #join").click(function(){$("body").append("<div id='fog' class='tourn'><div class='tourn-box'><h2>Ingresso em torneio</h2><p>Informe os dados do torneio que deseja participar</p><input id='name' class='input' placeholder='Identificador do torneio (nome)'><input id='pass' class='input' placeholder='Senha do torneio' type='password'><div id='button-container'><button id='cancel' class='button'>Cancelar</button><button id='join' class='button'>INGRESSAR</button></div></div></div>");
$(".tourn-box #name").focus();$(".tourn-box #cancel").click(function(){$("#fog").remove()});$(".tourn-box #name, .tourn-box #pass").keyup(function(a){13==a.keyCode&&$(".tourn-box #join").click();27==a.keyCode&&$("#fog").remove()});$(".tourn-box #join").click(function(){var a=$(".tourn-box #name").val(),b=$(".tourn-box #pass").val();$.post("back_tournament.php",{action:"JOIN",name:a,pass:b}).done(function(d){d=JSON.parse(d);"NOTFOUND"==d.status?($(".tourn-box #name").focus(),$(".tourn-box #name, .tourn-box #pass").addClass("error"),
$(".tourn-box .tip").remove(),$(".tourn-box #name").before("<span class='tip'>Torneio n\u00e3o encontrado</span>")):""!=d.hash?($(".tourn-box #cancel").click(),window.open("tourn/"+d.hash)):(refresh_teams({name:a,pass:b}),$(".tourn-box").html("<div id='title'><h2>Torneio<span>"+d.name+"</span></h2><div id='word'>Senha<span>"+d.pass+"</span></div></div><p>"+d.description+"</p><h3>Equipes inscritas <span id='count'></span></h3><div class='table'></div><div id='new-container'><button id='new' class='button'>Nova Equipe</button></div><div id='button-container'><button id='delete' class='button' hidden>REMOVER</button><button id='start' class='button' disabled>INICIAR TORNEIO</button><button id='close' class='button'>FECHAR</button></div>"),
""==d.pass&&$(".tourn-box #word").hide(),$(".tourn-box #close").click(function(){$("#fog").remove()}),$(".tourn-box #new").click(function(){$(".tourn-box #new").hide().after("<div class='input-button'><input placeholder='Nome da nova equipe' id='name'><button><i class='material-icons'>group_add</i></button></div>");$(".tourn-box #name").focus();$(".tourn-box #name").keyup(function(a){13==a.keyCode?$(".tourn-box .input-button button").click():27==a.keyCode&&($(".tourn-box .input-button").remove(),
$(".tourn-box #new").fadeIn(),$(".tourn-box .tip").remove())});$(".tourn-box .input-button button").click(function(){var c=$(".tourn-box #name").val();$(".tourn-box .tip").remove();3>c.length?($(".tourn-box #name").focus(),$(".tourn-box .input-button").before("<span class='tip'>Nome muito curto</span>")):$(".tourn-box .table").html().match(">"+c+"<")?($(".tourn-box #name").focus(),$(".tourn-box .input-button").before("<span class='tip'>Esta equipe j\u00e1 est\u00e1 registrada</span>")):choose_tourn_glad().then(function(d){!1!==
d&&$.post("back_tournament.php",{action:"TEAM_CREATE",name:c,tname:a,tpass:b,glad:d.glad,showcode:d.showcode}).done(function(d){"NOTFOUND"==d?showMessage("Torneio n\u00e3o encontrado"):"STARTED"==d?($("#fog.tourn").remove(),showMessage("Este torneio j\u00e1 iniciou")):"ALREADYIN"==d?showMessage("J\u00e1 est\u00e1 em um time neste torneio"):"EXISTS"==d?($(".tourn-box #name").focus(),$(".tourn-box .input-button").before("<span class='tip'>Esta equipe j\u00e1 est\u00e1 registrada</span>")):"FULL"==d?
showMessage("Este torneio j\u00e1 esgotou o limite de inscri\u00e7\u00f5es"):(d=JSON.parse(d),$(".tourn-box .input-button").remove(),$(".tourn-box #new").fadeIn(),d="<div id='fog' class='message'><div id='tourn-message' class='tourn-box'><h2>Equipe <span>"+c+"</span> registrada</h2><p>Os mestres dever\u00e3o informar a seguinte senha para ingressar nesta equipe:</p><div>Senha: <span>"+d.word+"</span></div><div id='button-container'><button class='button'>OK</button></div></div></div>",$("body").append(d),
$("#tourn-message .button").click(function(){$("#fog.message").remove();$(".tourn-box .table .row").last().click()}),refresh_teams({name:a,pass:b}))})})})}))})})});$("#panel .title #offset button").click(function(){var a;$(this).parent().hasClass("open")&&(a="open");$(this).parent().hasClass("mine")&&(a="mine");"prev"==$(this).attr("id")&&(tournpage[a].offset-=10);"next"==$(this).attr("id")&&(tournpage[a].offset+=10);refresh_tourn_list()})});var tournpage={mine:{offset:0},open:{offset:0}};
function refresh_tourn_list(){$("#panel #battle-mode #tourn.button").hasClass("selected")&&$.post("back_tournament.php",{action:"LIST",moffset:tournpage.mine.offset,ooffset:tournpage.open.offset}).done(function(a){if($("#panel #battle-mode #tourn.button").hasClass("selected")){a=JSON.parse(a);var b=a.open,d=a.mytourn;tournpage.mine.offset=parseInt(a.pages.mine.offset);tournpage.mine.total=parseInt(a.pages.mine.total);tournpage.mine.end=Math.min(tournpage.mine.total,tournpage.mine.offset+10);tournpage.open.offset=
parseInt(a.pages.open.offset);tournpage.open.total=parseInt(a.pages.open.total);tournpage.open.end=Math.min(tournpage.open.total,tournpage.open.offset+10);$("#panel #battle-container #tourn.wrapper #offset.mine .start").html(tournpage.mine.offset+1);$("#panel #battle-container #tourn.wrapper #offset.open .start").html(tournpage.open.offset+1);$("#panel #battle-container #tourn.wrapper #offset.mine .end").html(tournpage.mine.end);$("#panel #battle-container #tourn.wrapper #offset.open .end").html(tournpage.open.end);
$("#panel #battle-container #tourn.wrapper #offset.mine .total").html(tournpage.mine.total);$("#panel #battle-container #tourn.wrapper #offset.open .total").html(tournpage.open.total);$("#panel #battle-container #tourn.wrapper #offset button").removeProp("disabled");0==tournpage.mine.offset&&$("#panel #battle-container #tourn.wrapper #offset.mine #prev").prop("disabled",!0);0==tournpage.open.offset&&$("#panel #battle-container #tourn.wrapper #offset.open #prev").prop("disabled",!0);tournpage.mine.end==
tournpage.mine.total&&$("#panel #battle-container #tourn.wrapper #offset.mine #next").prop("disabled",!0);tournpage.open.end==tournpage.open.total&&$("#panel #battle-container #tourn.wrapper #offset.open #next").prop("disabled",!0);$("#panel #battle-container #tourn.wrapper #table-open").html("<div class='row head'><div class='cell'>Identificador</div><div class='cell'>Descri\u00e7\u00e3o</div><div class='cell'>Equipes</div><div class='cell'>Flex</div></div>");for(var c in b)$("#panel #battle-container #tourn.wrapper #table-open").append("<div class='row'><div class='cell' id='name'>"+
b[c].name+"</div><div class='cell'>"+b[c].description+"</div><div class='cell'>"+b[c].teams+"/"+b[c].maxteams+"</div><div class='cell flex'>"+b[c].flex+"</div></div>");$("#mytourn-title").hide();if(0<d.length){$("#panel #battle-container #tourn.wrapper #table-mytourn").html("<div class='row head'><div class='cell'>Identificador</div><div class='cell'>Descri\u00e7\u00e3o</div><div class='cell'>Equipes</div><div class='cell'>Flex</div></div>");for(var e in d)$("#panel #battle-container #tourn.wrapper #table-mytourn").append("<div class='row'><div class='cell' id='name'>"+
d[e].name+"</div><div class='cell'>"+d[e].description+"</div><div class='cell'>"+d[e].teams+"/"+d[e].maxteams+"</div><div class='cell flex'>"+d[e].flex+"</div></div>");$("#mytourn-title").show()}$("#panel #battle-container #tourn.wrapper .table .cell.flex").each(function(){"1"==$(this).html()?$(this).html("<i class='material-icons md-18 md-green'>done</i>"):"0"==$(this).html()&&$(this).html("")});$("#panel #battle-container #tourn.wrapper .table .row").not(".head").click(function(){var a=$(this).find("#name").text();
$.post("back_tournament.php",{action:"JOIN",name:a}).done(function(a){a=JSON.parse(a);$("#tourn.wrapper #join").click();$(".tourn-box #name").val(a.name);$(".tourn-box #pass").val(a.pass);$(".tourn-box #join").click()})})}count_refresh_tour_list++;setTimeout(function(){count_refresh_tour_list--;0==count_refresh_tour_list&&refresh_tourn_list()},1E4)})}
function refresh_teams(a){$("#fog.tourn").length&&$.post("back_tournament.php",{action:"LIST_TEAMS",name:a.name,pass:a.pass,tourn:a.tourn}).done(function(b){b=JSON.parse(b);if("STARTED"==b.status){var d=b.hash;$("#fog.tourn, #fog.team").remove();showDialog("Este torneio j\u00e1 iniciou. Deseja acompanh\u00e1-lo?",["Sim","N\u00e3o"]).then(function(a){"Sim"==a&&window.open("tourn/"+d)})}else{var c=b.teams,e=!1;b.joined&&(e=b.joined);if(0==c.length)$(".tourn-box .table").html("<div class='row'>Nenhuma equipe inscrita</div>"),
$(".tourn-box h3 #count").html("");else{$(".tourn-box .table").html("<div class='row head'><div class='cell'>Nome</div><div class='cell'>Gladiadores</div></div>");for(var g in c)$(".tourn-box .table").append("<div class='row'><div class='cell'>"+c[g].name+"</div><div class='cell'>"+c[g].glads+"/3</div><div class='kick' title='Expulsar equipe'><i class='material-icons'>cancel</i></div></div>"),rebind_team_rows(c[g].id),e&&e===c[g].id?$(".tourn-box .table .row").last().addClass("signed"):3==c[g].glads&&
$(".tourn-box .table .row").last().addClass("full");$(".tourn-box h3 #count").html("("+c.length+"/"+b.maxteams+")")}1==b.filled&&1==b.manager&&1<c.length?($(".tourn-box #button-container #start").removeProp("disabled"),$(".tourn-box #button-container #start").off(),$(".tourn-box #button-container #start").click(function(){showDialog("Deseja iniciar o torneio? Ap\u00f3s o in\u00edcio, as equipes n\u00e3o poder\u00e3o mais ser alteradas",["Sim","N\u00c3O"]).then(function(b){"Sim"==b&&$.post("back_tournament.php",
{action:"START",name:a.name,pass:a.pass}).done(function(a){a=JSON.parse(a);"DONE"==a.status&&(a=a.hash,$(".tourn-box #close").click(),window.open("tourn/"+a),$.post("back_sendmail.php",{action:"TOURNAMENT",hash:a}).done(function(a){}))})})})):$(".tourn-box #button-container #start").prop("disabled",!0);1==b.manager&&0==c.length?($(".tourn-box #button-container #delete").show(),$(".tourn-box #button-container #start").hide(),$(".tourn-box #button-container #delete").off(),$(".tourn-box #button-container #delete").click(function(){showDialog("Deseja remover o torneio?",
["Sim","N\u00c3O"]).then(function(b){"Sim"==b&&$.post("back_tournament.php",{action:"DELETE",name:a.name,pass:a.pass,tourn:a.tourn}).done(function(a){"DELETED"==a?(showMessage("Torneio removido"),$("#fog").remove(),refresh_tourn_list()):"STARTED"==a?showMessage("Este torneio j\u00e1 iniciou"):showMessage("Um torneio s\u00f3 pode ser removido quando n\u00e3o possuir equipes")})})})):0==b.manager?($(".tourn-box .table .row .kick").remove(),$(".tourn-box #button-container #delete").remove(),$(".tourn-box #button-container #start").remove(),
$(".tourn-box #button-container #close").addClass("single")):1==b.manager&&($(".tourn-box #button-container #delete").hide(),$(".tourn-box #button-container #start").show(),$(".tourn-box .kick").click(function(b){b.stopPropagation();var c=$(this).parents(".row").find(".cell").eq(0).html();showDialog("Deseja expulsar a equipe <span class='highlight'>"+c+"</span> do torneio?",["Sim","N\u00e3o"]).then(function(b){"Sim"==b&&$.post("back_tournament.php",{action:"KICK",name:a.name,pass:a.pass,teamname:c}).done(function(b){b=
JSON.parse(b);"DONE"==b.status&&refresh_teams(a);showMessage("Equipe <span class='highlight'>"+c+"</span> removida do torneio")})})}));!1!==e||c.length>=b.maxteams?$(".tourn-box #new-container").hide():$(".tourn-box #new-container").show();count_refresh_teams++;setTimeout(function(){count_refresh_teams--;0==count_refresh_teams&&refresh_teams({name:a.name,pass:a.pass,tourn:a.tourn})},1E4)}})}
function rebind_team_rows(a){$(".tourn-box .table .row").last().click(function(){teamsync.time=0;var b=$(this).find(".cell").eq(0).html(),d="<div id='fog' class='team'><div class='tourn-box'><div id='title'><h2>Equipe <span>"+b+"</span></h2><div id='word'>Senha<span></span></div></div><h3>Gladiadores inscritos</h3><div class='glad-card-container'></div><div id='button-container'><button id='back' class='button'>VOLTAR</button><button id='join-leave' class='button'>ABANDONAR</button></div></div></div>";
$("#fog .tourn-box").hide();$("body").append(d);$(".tourn-box #back").click(function(){$("#fog.team").remove();$("#fog .tourn-box").fadeIn()});$(".tourn-box #join-leave").click(function(){"ABANDONAR"==$(".tourn-box #join-leave").html()?showDialog("Tem certeza que deseja sair da equipe <span class='highlight'>"+b+"</span>?",["N\u00e3o","SIM"]).then(function(c){"SIM"==c&&$.post("back_tournament.php",{action:"LEAVE_TEAM",id:a}).done(function(a){a=JSON.parse(a);var c=a.tourn;$("#fog.team").remove();if("STARTED"==
a.status)showMessage("Este torneio j\u00e1 iniciou");else{var d="Voc\u00ea n\u00e3o faz mais parte da equipe <span class='highlight'>"+b+"</span>";"REMOVED"==a.status&&(d="A equipe <span class='highlight'>"+b+"</span> foi desmantelada");showMessage(d).then(function(a){$(".tourn-box").fadeIn();refresh_teams({tourn:c})})}})}):choose_tourn_glad().then(function(c){if(!1!==c){var d=c.glad,g=c.showcode;showInput("Senha para ingressar na equipe").then(function(c){!1!==c&&$.post("back_tournament.php",{action:"JOIN_TEAM",
pass:c,team:a,glad:d,showcode:g}).done(function(a){a=JSON.parse(a);var c=a.tourn;"FAIL"==a.status?showMessage("Senha incorreta"):"STARTED"==a.status?showMessage("Este torneio j\u00e1 iniciou"):"SIGNED"==a.status?showMessage("Voc\u00ea j\u00e1 participa de uma equipe deste torneio"):(showMessage("Voc\u00ea ingressou na equipe <span class='highlight'>"+b+"</span>").then(function(){$(".tourn-box .row.signed").click()}),$(".tourn-box #back").click(),refresh_teams({tourn:c}))})})}})});refresh_glads(a)})}
function refresh_glads(a){teamsync.id!=a&&(teamsync={id:a,time:0});$.post("back_tournament.php",{action:"TEAM",id:a,sync:teamsync.time}).done(function(b){b=JSON.parse(b);if("DONE"==b.status){var d=b.name,c=b.word,e=b.flex,g=!1;teamsync.time=b.sync;b.joined&&(g=b.joined);b=b.glads;c?$("#fog.team .tourn-box #word span").html(c):$("#fog.team .tourn-box #word").remove();var h=$("<div id='template'></div>").load("glad-card-template.html",function(){$(".tourn-box .glad-card-container").html("");for(var k in b)$(".tourn-box .glad-card-container").append("<div class='glad-preview'></div>");
$(".tourn-box .glad-card-container .glad-preview").html(h);for(var f in b)b[f].name?(setGladImage($(".tourn-box .glad-card-container"),f,b[f].skin),$(".tourn-box .glad-preview .info .glad span").eq(f).html(b[f].name),$(".tourn-box .glad-preview .info .attr .str span").eq(f).html(b[f].vstr),$(".tourn-box .glad-preview .info .attr .agi span").eq(f).html(b[f].vagi),$(".tourn-box .glad-preview .info .attr .int span").eq(f).html(b[f].vint),$(".tourn-box .glad-preview").eq(f).data("id",b[f].cod),$(".tourn-box .glad-preview .info .master").eq(f).html(b[f].apelido),
b[f].owner&&!0===b[f].owner&&$(".tourn-box .glad-preview").eq(f).addClass("mine")):($(".tourn-box .glad-preview").eq(f).addClass("blurred"),setGladImage($(".tourn-box .glad-card-container"),f,""),$(".tourn-box .glad-preview .info .glad span").eq(f).html("??????????"),$(".tourn-box .glad-preview .info .attr .str span").eq(f).html("??"),$(".tourn-box .glad-preview .info .attr .agi span").eq(f).html("??"),$(".tourn-box .glad-preview .info .attr .int span").eq(f).html("??"),$(".tourn-box .glad-preview .info .master").eq(f).html(b[f]));
$(".glad-preview .code").remove();$(".glad-preview").not(".mine").find(".delete-container").remove();$(".glad-preview.mine .delete").click(function(){var b=$(this).parents(".mine").data("id"),c=$(this).parents(".mine").find(".row.glad span").html();showDialog("Deseja remover o gladiador <span class='highlight'>"+c+"</span> da equipe?",["Sim","N\u00e3o"]).then(function(e){"Sim"==e&&$.post("back_tournament.php",{action:"REMOVE_GLAD",glad:b,team:a}).done(function(a){a=JSON.parse(a);"STARTED"==a.status?
($("#fog.team").remove(),showMessage("Este torneio j\u00e1 iniciou")):"REMOVED"==a.status?($("#fog.team").remove(),showMessage("A equipe <span class='highlight'>"+d+"</span> foi desmantelada").then(function(){$(".tourn-box").fadeIn();refresh_teams({tourn:a.tournid})})):"DONE"==a.status?($(".tourn-box #back").click(),showMessage("O gladiador <span class='highlight'>"+c+"</span> foi removido da equipe").then(function(){$(".tourn-box .row.signed").click()})):showMessage(a.status)})})});for(k=0;k<3-b.length;k++)$(".tourn-box .glad-card-container").append("<div class='glad-add'><div class='image'></div><div class='info'>Clique para inscrever um novo gladiador</div></div>");
0<$(".tourn-box .glad-preview.blurred").length&&($(".tourn-box .glad-add").addClass("disabled"),$(".tourn-box #join-leave").html("INGRESSAR"));"0"==e&&$(".tourn-box .glad-add").addClass("disabled");(g||3<=b.length)&&"INGRESSAR"==$(".tourn-box #join-leave").html()&&($("#fog.team .tourn-box #join-leave").remove(),$("#fog.team .tourn-box #button-container .button").addClass("single"));$(".tourn-box .glad-add").not(".disabled").click(function(){choose_tourn_glad().then(function(b){!1!==b&&$.post("back_tournament.php",
{action:"ADD_GLAD",glad:b.glad,showcode:b.showcode,team:a,pass:c}).done(function(a){a=JSON.parse(a);"SAMEGLAD"==a.status?showMessage("Este gladiador j\u00e1 faz parte da equipe"):"STARTED"==a.status?($("#fog.team").remove(),showMessage("Este torneio j\u00e1 iniciou")):"DONE"==a.status&&($("#fog.team").remove(),$(".tourn-box .row.signed").click())})})})})}});count_refresh_glads++;setTimeout(function(){count_refresh_glads--;0==count_refresh_glads&&refresh_glads(a)},1E4)}
function choose_tourn_glad(){var a=$.Deferred();$("body").append("<div id='fog' class='glads'><div id='duel-box'><div id='title'>Escolha o gladiador que ir\u00e1 lhe representar no torneio</div><div class='glad-card-container'></div><div id='show-code'><label><input type='checkbox' class='checkslider'>Permitir que minha equipe veja o c\u00f3digo do gladiador</label></div><div id='button-container'><button id='cancel' class='button'>Cancelar</button><button id='choose' class='button' disabled>ESCOLHER</button></div></div></div>");
create_checkbox($("#duel-box .checkslider"));var b=$("<div id='template'></div>").load("glad-card-template.html",function(){});$.post("back_glad.php",{action:"GET"}).done(function(a){a=JSON.parse(a);for(var c in a)$("#fog.glads .glad-card-container").append("<div class='glad-preview'></div>");$("#fog.glads .glad-card-container .glad-preview").html(b);for(c in a)setGladImage($("#fog.glads .glad-card-container"),c,a[c].skin),$("#fog.glads .glad-preview .info .glad span").eq(c).html(a[c].name),$("#fog.glads .glad-preview .info .attr .str span").eq(c).html(a[c].vstr),
$("#fog.glads .glad-preview .info .attr .agi span").eq(c).html(a[c].vagi),$("#fog.glads .glad-preview .info .attr .int span").eq(c).html(a[c].vint),$("#fog.glads .glad-preview").eq(c).data("id",a[c].id),a[c].oldversion&&$("#fog.glads .glad-preview").eq(c).addClass("old").attr("title","Este gladiador precisa ser atualizado");$("#fog.glads .glad-preview .code .button").remove();$("#fog.glads .glad-preview .delete-container").remove();$("#fog.glads .glad-preview").not(".old").click(function(){$("#fog.glads #btn-glad-open").removeProp("disabled");
$("#fog.glads .glad-preview").removeClass("selected");$(this).addClass("selected");$("#duel-box #choose").removeProp("disabled")});$("#fog.glads .glad-preview").dblclick(function(){$("#fog.glads #duel-box #choose").click()})});$("#duel-box #cancel").click(function(){$("#fog.glads").remove();return a.resolve(!1)});$("#duel-box #choose").click(function(){if($("#fog.glads .glad-preview.selected").length){var b=$("#fog.glads .glad-preview.selected").data("id"),c=$("#duel-box input.checkslider").prop("checked");
$("#fog.glads").remove();return a.resolve({glad:b,showcode:c})}});return a.promise()};
